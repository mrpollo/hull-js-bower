this.Hull=this.Hull||{},this.Hull.templates=this.Hull.templates||{},this.Hull.templates._default=this.Hull.templates._default||{},Hull.templates._default["video/player/main"]=function(i,e,t,s,n){function a(i,e){var s,n,a="";return a+='\n    <video id="'+c((s=i&&i.video,s=null==s||s===!1?s:s.id,typeof s===u?s.apply(i):s))+'" class="video-js vjs-default-skin" controls preload="auto" poster=',(n=t.poster)?s=n.call(i,{hash:{},data:e}):(n=i&&i.poster,s=typeof n===u?n.call(i,{hash:{},data:e}):n),a+=c(s)+">\n      ",s=t["if"].call(i,i&&i.hls,{hash:{},inverse:p.noop,fn:p.program(2,o,e),data:e}),(s||0===s)&&(a+=s),a+='\n      <source type="'+c((s=i&&i.file,s=null==s||s===!1?s:s.content_type,typeof s===u?s.apply(i):s))+'" src="'+c((s=i&&i.file,s=null==s||s===!1?s:s.url,typeof s===u?s.apply(i):s))+'">\n    </video>\n  '}function o(i,e){var s,n,a="";return a+='\n        <source type="application/x-mpegurl" src="',(n=t.hls)?s=n.call(i,{hash:{},data:e}):(n=i&&i.hls,s=typeof n===u?n.call(i,{hash:{},data:e}):n),a+=c(s)+'">\n      '}function l(){return"\n    <p>Your video is processing.</p>\n  "}function r(){return"\n    </p>Video encoding has failed, please retry later.</p>\n  "}this.compilerInfo=[4,">= 1.0.0"],t=this.merge(t,i.helpers),n=n||{};var d,h="",u="function",c=this.escapeExpression,p=this;return h+='<div class="video-container">\n  ',d=t["if"].call(e,e&&e.isFinished,{hash:{},inverse:p.noop,fn:p.program(1,a,n),data:n}),(d||0===d)&&(h+=d),h+="\n\n  ",d=t["if"].call(e,e&&e.isProcessing,{hash:{},inverse:p.noop,fn:p.program(4,l,n),data:n}),(d||0===d)&&(h+=d),h+="\n\n  ",d=t["if"].call(e,e&&e.hasFailed,{hash:{},inverse:p.noop,fn:p.program(6,r,n),data:n}),(d||0===d)&&(h+=d),h+="\n</div>\n"},Hull.component("video/player@hull",{datasources:{video:":id"},templates:["main"],require:["//vjs.zencdn.net/4.2.1/video.js"],initialize:function(){this.trackPlayer=this.sandbox.util._.throttle(function(i){var e,t=Math.round(i.currentTime()/i.duration()*100);t>10&&80>t&&!this.playTracked?(this.playTracked=!0,e="video.play"):t>=80&&!this.completeTracked&&(this.completeTracked=!0,e="video.complete"),e&&this.track(e,{id:this.options.id})},500)},beforeRender:function(i){if(this.currentState=this.currentState||i.video.state,i.isProcessing=this.isProcessing(i.video.state),i.hasFailed=this.hasFailed(i.video.state),i.isFinished="finished"===i.video.state,i.isFinished){i.poster=i.video.picture||i.video.thumbnails[0],i.video.files.hls&&(i.hls=i.video.base_url+"/"+i.video.files.hls.name);var e=i.video.files[this.options.quality]||i.video.files.standard;e.url=i.video.base_url+"/"+e.name,i.file=e,i.width=e.width,i.height=e.height}},afterRender:function(i){if(this.isProcessing(i.video.state))this.poll(i.video.id);else{var e={width:this.options.width||i.width,height:this.options.height||i.height},t=this;videojs(i.video.id,e).on("timeupdate",function(){t.trackPlayer(this)})}},poll:function(i){var e=this.sandbox.util._;this.api(i).then(e.bind(function(t){if(this.currentState!==t.state&&(this.currentState=t.state,this.render()),this.isProcessing(t.state)){var s=this.options.interval||1e4;setTimeout(e.bind(this.poll,this),s,i)}},this))},isProcessing:function(i){return this.sandbox.util._.include(["pending","scheduled","submitted","waiting","processing"],i)},hasFailed:function(i){return this.sandbox.util._.include(["submition_failed","submition_error","failed","canceled"],i)}});