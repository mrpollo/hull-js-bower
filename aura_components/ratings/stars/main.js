this.Hull=this.Hull||{},this.Hull.templates=this.Hull.templates||{},this.Hull.templates._default=this.Hull.templates._default||{},Hull.templates._default["ratings/stars/stars"]=function(a,t,e,l,s){function n(a,t,l){var s,n="";return n+="\n    ",s=e["if"].call(a,l&&l.loggedIn,{hash:{},inverse:v.program(4,r,t),fn:v.program(2,i,t),data:t}),(s||0===s)&&(n+=s),n+="\n  "}function i(a,t){var l,s,n,i="";return i+='\n      <a href="#" class="rating '+d((s=e.outputIf||a&&a.outputIf,n={hash:{},data:t},s?s.call(a,a&&a.active,!1,"muted","",n):p.call(a,"outputIf",a&&a.active,!1,"muted","",n)))+" rating-",(s=e.value)?l=s.call(a,{hash:{},data:t}):(s=a&&a.value,l=typeof s===g?s.call(a,{hash:{},data:t}):s),i+=d(l)+'" data-hull-action="rate" data-hull-rating="',(s=e.value)?l=s.call(a,{hash:{},data:t}):(s=a&&a.value,l=typeof s===g?s.call(a,{hash:{},data:t}):s),i+=d(l)+'">&#9733;</a>\n    '}function r(a,t){var l,s,n,i="";return i+='\n      <span class="rating '+d((s=e.outputIf||a&&a.outputIf,n={hash:{},data:t},s?s.call(a,a&&a.active,!1,"muted",n):p.call(a,"outputIf",a&&a.active,!1,"muted",n)))+" rating-",(s=e.value)?l=s.call(a,{hash:{},data:t}):(s=a&&a.value,l=typeof s===g?s.call(a,{hash:{},data:t}):s),i+=d(l)+'">&#9733;</span>\n    '}this.compilerInfo=[4,">= 1.0.0"],e=this.merge(e,a.helpers),s=s||{};var u,o,h,c="",p=e.helperMissing,d=this.escapeExpression,g="function",v=this;return c+='<span class="ratings ratings-',(o=e.average)?u=o.call(t,{hash:{},data:s}):(o=t&&t.average,u=typeof o===g?o.call(t,{hash:{},data:s}):o),c+=d(u)+'">\n  ',u=e.each.call(t,t&&t.ratings,{hash:{},inverse:v.noop,fn:v.programWithDepth(1,n,s,t),data:s}),(u||0===u)&&(c+=u),c+="\n  â€¢\n  "+d((o=e.fallback||t&&t.fallback,h={hash:{},data:s},o?o.call(t,(u=t&&t.target,u=null==u||u===!1?u:u.stats,u=null==u||u===!1?u:u.reviews,null==u||u===!1?u:u.count),0,h):p.call(t,"fallback",(u=t&&t.target,u=null==u||u===!1?u:u.stats,u=null==u||u===!1?u:u.reviews,null==u||u===!1?u:u.count),0,h)))+" reviews\n</span>\n"},Hull.component("ratings/stars@hull",{type:"Hull",templates:["stars"],refreshEvents:["model.hull.me.change"],requiredOptions:["id"],datasources:{target:":id"},options:{max:5,actionable:"true"},actions:{rate:function(a,t){this.rate(t.data.rating),a.preventDefault()}},initialize:function(){this.sandbox.on("hull.reviews."+this.options.id+".**",function(){this.render()},this)},beforeRender:function(a){a.average=a.target&&a.target.stats.reviews?a.target.stats.reviews.avg:0,a.average=this.normalizeRating(a.average);for(var t=[],e=0;e<this.options.max;e)t[e]={value:++e,active:e<=a.average};a.ratings=t},rate:function(a){var t=this,a=this.normalizeRating(a);this.api(this.options.id+"/reviews","post",{rating:a}).done(function(a){t.sandbox.emit("hull.reviews."+t.options.id+".updated",a),t.sandbox.emit("hull.ratings.rate.complete",a),t.render()})},normalizeRating:function(a){var a=parseInt(a,10);return isNaN(a)||0>a?0:a>this.options.max?this.options.max:a}});