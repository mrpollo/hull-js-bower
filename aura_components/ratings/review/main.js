this.Hull=this.Hull||{},this.Hull.templates=this.Hull.templates||{},this.Hull.templates._default=this.Hull.templates._default||{},Hull.templates._default["ratings/review/form"]=function(e,a,i,n,t){function l(e,a){var n,t,l,r="";return r+='\n    <form>\n      <div class=\'media\'>\n        <div class="pull-left">\n          <img class="media-object img-rounded" src="'+u((n=e&&e.me,n=null==n||n===!1?n:n.picture,typeof n===h?n.apply(e):n))+'" alt="'+u((n=e&&e.me,n=null==n||n===!1?n:n.name,typeof n===h?n.apply(e):n))+'" width="50" height="50">\n        </div>\n        <div class="media-body">\n          <div>\n            <select name="rating">\n              <option></option>\n              ',l={hash:{},inverse:p.noop,fn:p.program(2,s,a),data:a},(t=i.range)?n=t.call(e,l):(t=e&&e.range,n=typeof t===h?t.call(e,l):t),i.range||(n=c.call(e,n,{hash:{},inverse:p.noop,fn:p.program(2,s,a),data:a})),(n||0===n)&&(r+=n),r+='\n            </select>\n          </div>\n          <div>\n            <textarea name=\'description\' class="input-block-level" rows="3" placeholder="Write a review...">'+u((n=e&&e.review,n=null==n||n===!1?n:n.description,typeof n===h?n.apply(e):n))+'</textarea>\n          </div>\n          <div>\n            <button data-hull-action="review" disabled class="btn btn-small btn-primary">Review as '+u((n=e&&e.me,n=null==n||n===!1?n:n.name,typeof n===h?n.apply(e):n))+'</button>\n            <div class=\'pull-right\'>\n              <small>\n                <a href="#" data-hull-action="logout" class="link">Logout</a>\n              </small>\n            </div>\n          </div>\n        </div>\n      </div>\n    </form>\n  '}function s(e){var a="";return a+='\n              <option value="'+u(typeof e===h?e.apply(e):e)+'">'+u(typeof e===h?e.apply(e):e)+"</option>\n              "}function r(){return'\n    <div data-hull-component="login/button@hull"></div>\n  '}this.compilerInfo=[4,">= 1.0.0"],i=this.merge(i,e.helpers),t=t||{};var o,d="",h="function",u=this.escapeExpression,p=this,c=i.blockHelperMissing;return d+='<div class="well">\n  ',o=i["if"].call(a,a&&a.loggedIn,{hash:{},inverse:p.program(4,r,t),fn:p.program(1,l,t),data:t}),(o||0===o)&&(d+=o),d+="\n</div>\n"},Hull.templates._default["ratings/review/list"]=function(e,a,i,n,t){function l(e,a){var n,t,l,r="";return r+='\n  <ul class="media-list hull-reviews__list">\n    ',l={hash:{},inverse:m.noop,fn:m.programWithDepth(2,s,a,e),data:a},(t=i.reviews)?n=t.call(e,l):(t=e&&e.reviews,n=typeof t===c?t.call(e,l):t),i.reviews||(n=g.call(e,n,{hash:{},inverse:m.noop,fn:m.programWithDepth(2,s,a,e),data:a})),(n||0===n)&&(r+=n),r+="\n  </ul>\n"}function s(e,a,n){var t,l,s,o="";return o+='\n      <li class="media" data-hull-review-id="',(l=i.id)?t=l.call(e,{hash:{},data:a}):(l=e&&e.id,t=typeof l===c?l.call(e,{hash:{},data:a}):l),o+=v(t)+'">\n        <div class="pull-left">\n          <img class="media-object img-rounded" src="'+v((t=e&&e.user,t=null==t||t===!1?t:t.picture,typeof t===c?t.apply(e):t))+'" alt="'+v((t=e&&e.user,t=null==t||t===!1?t:t.name,typeof t===c?t.apply(e):t))+'" width="50" height="50">\n        </div>\n        <div class="media-body">\n          <div class="pull-right">\n\n          </div>\n          <h4 class="media-heading">\n            <span class="pull-right badge">',(l=i.rating)?t=l.call(e,{hash:{},data:a}):(l=e&&e.rating,t=typeof l===c?l.call(e,{hash:{},data:a}):l),o+=v(t)+"</span>\n            "+v((t=e&&e.user,t=null==t||t===!1?t:t.name,typeof t===c?t.apply(e):t))+'\n            â€¢\n            <small class="muted">'+v((l=i.fromNow||e&&e.fromNow,s={hash:{},data:a},l?l.call(e,e&&e.updated_at,s):f.call(e,"fromNow",e&&e.updated_at,s)))+'</small>\n          </h4>\n          <div class="hull-reviews__description">\n            ',(l=i.description)?t=l.call(e,{hash:{},data:a}):(l=e&&e.description,t=typeof l===c?l.call(e,{hash:{},data:a}):l),o+=v(t)+'\n          </div>\n          <div class="hull-reviews__actions">\n              ',l=i.ifEqual||n&&n.ifEqual,s={hash:{},inverse:m.noop,fn:m.program(3,r,a),data:a},t=l?l.call(e,(t=n&&n.me,null==t||t===!1?t:t.id),(t=e&&e.user,null==t||t===!1?t:t.id),s):f.call(e,"ifEqual",(t=n&&n.me,null==t||t===!1?t:t.id),(t=e&&e.user,null==t||t===!1?t:t.id),s),(t||0===t)&&(o+=t),o+="\n          </div>\n        </div>\n      </li>\n    "}function r(e,a){var n,t,l="";return l+='\n                <small>\n                  <a href="#" class=\'link\' data-hull-action="delete" data-hull-id="',(t=i.id)?n=t.call(e,{hash:{},data:a}):(t=e&&e.id,n=typeof t===c?t.call(e,{hash:{},data:a}):t),l+=v(n)+'">Delete</a>\n                </small>\n              '}function o(){return'\n  <div class="alert alert-info">\n    No reviews for the moment\n  </div>\n'}this.compilerInfo=[4,">= 1.0.0"],i=this.merge(i,e.helpers),n=this.merge(n,e.partials),t=t||{};var d,h,u,p="",c="function",v=this.escapeExpression,f=i.helperMissing,m=this,g=i.blockHelperMissing;return d=m.invokePartial(n["ratings/review/form"],"ratings/review/form",a,i,n,t),(d||0===d)&&(p+=d),p+="\n\n",d=i["if"].call(a,a&&a.reviews,{hash:{},inverse:m.noop,fn:m.program(1,l,t),data:t}),(d||0===d)&&(p+=d),p+="\n\n",u={hash:{},inverse:m.program(5,o,t),fn:m.noop,data:t},(h=i.reviews)?d=h.call(a,u):(h=a&&a.reviews,d=typeof h===c?h.call(a,u):h),i.reviews||(d=g.call(a,d,{hash:{},inverse:m.program(5,o,t),fn:m.noop,data:t})),(d||0===d)&&(p+=d),p+="\n"},Hull.component("ratings/review@hull",{type:"Hull",refreshEvents:["model.hull.me.change"],templates:["list","form"],requiredOptions:["id"],datasources:{review:":id/reviews/me",reviews:":id/reviews"},events:{'change [name="rating"]':"checkButtonStatus"},options:{focus:!1,perPage:10,page:1,max:5},actions:{review:"postReview","delete":"deleteReview"},initialize:function(){this.sandbox.on("hull.reviews."+this.options.id+".**",function(){this.render()},this)},checkButtonStatus:function(){var e=!this.$find('select[name="rating"]').val();this.$find('[data-hull-action="review"]').attr("disabled",e)},toggleLoading:function(){this.$el.toggleClass("is-loading"),this.$find("input,textarea,button").attr("disabled",this.$el.hasClass("is-loading"))},beforeRender:function(e){e.range=this.sandbox.util._.range(this.options.max+1),e.range.shift()},afterRender:function(e){(this.options.focus||this.focusAfterRender)&&(this.$el.find("input,textarea").focus(),this.focusAfterRender=!1),e.review&&e.review.rating&&this.$find("select[name='rating']").val(e.review.rating),this.checkButtonStatus()},postReview:function(e){e.preventDefault();var a=this,i=this.$find("form"),n=this.sandbox.dom.getFormData(i),t=n.rating;this.toggleLoading(),t&&this.api(this.options.id+"/reviews","post",n).then(function(e){a.sandbox.emit("hull.reviews."+a.options.id+".added",e),a.toggleLoading(),a.focusAfterRender=!0,a.render()})},deleteReview:function(e,a){e.preventDefault();var i=this,n=a.data.id,t=a.el.addClass("is-removing").parents('[data-hull-review-id="'+n+'"]');this.api(n,"delete").then(function(e){i.sandbox.emit("hull.reviews."+i.options.id+".removed",e),t.remove()})}});