this.Hull=this.Hull||{},this.Hull.templates=this.Hull.templates||{},this.Hull.templates._default=this.Hull.templates._default||{},Hull.templates._default["registration/form/complete"]=function(a,l,e,t,n){function r(){return'\n    <button class="btn" data-hull-action="edit">Edit my Profile</button>\n  '}this.compilerInfo=[4,">= 1.0.0"],e=this.merge(e,a.helpers),n=n||{};var o,h="",i=this;return h+='<div class="hull-registration hull-registration--complete">\n  <p>Registration complete... thanks </p>\n  ',o=e["if"].call(l,(o=l&&l.options,null==o||o===!1?o:o.editable),{hash:{},inverse:i.noop,fn:i.program(1,r,n),data:n}),(o||0===o)&&(h+=o),h+="\n</div>\n"},Hull.templates._default["registration/form/form"]=function(a,l,e,t,n){function r(a,l){var t,n,r,i="";return i+='\n        <div class="hull-form-field hull-form-field--',(n=e.type)?t=n.call(a,{hash:{},data:l}):(n=a&&a.type,t=typeof n===q?n.call(a,{hash:{},data:l}):n),i+=E(t)+" ",r={hash:{},inverse:_.noop,fn:_.program(2,o,l),data:l},(n=e.required)?t=n.call(a,r):(n=a&&a.required,t=typeof n===q?n.call(a,r):n),e.required||(t=H.call(a,t,{hash:{},inverse:_.noop,fn:_.program(2,o,l),data:l})),(t||0===t)&&(i+=t),i+='">\n          ',n=e.ifEqual||a&&a.ifEqual,r={hash:{},inverse:_.noop,fn:_.program(4,h,l),data:l},t=n?n.call(a,a&&a.type,"text",r):x.call(a,"ifEqual",a&&a.type,"text",r),(t||0===t)&&(i+=t),i+="\n\n          ",n=e.ifEqual||a&&a.ifEqual,r={hash:{},inverse:_.noop,fn:_.program(11,d,l),data:l},t=n?n.call(a,a&&a.type,"email",r):x.call(a,"ifEqual",a&&a.type,"email",r),(t||0===t)&&(i+=t),i+="\n\n          ",n=e.ifEqual||a&&a.ifEqual,r={hash:{},inverse:_.noop,fn:_.program(11,d,l),data:l},t=n?n.call(a,a&&a.type,"url",r):x.call(a,"ifEqual",a&&a.type,"url",r),(t||0===t)&&(i+=t),i+="\n\n          ",n=e.ifEqual||a&&a.ifEqual,r={hash:{},inverse:_.noop,fn:_.program(11,d,l),data:l},t=n?n.call(a,a&&a.type,"tel",r):x.call(a,"ifEqual",a&&a.type,"tel",r),(t||0===t)&&(i+=t),i+="\n\n          ",n=e.ifEqual||a&&a.ifEqual,r={hash:{},inverse:_.noop,fn:_.program(13,f,l),data:l},t=n?n.call(a,a&&a.type,"select",r):x.call(a,"ifEqual",a&&a.type,"select",r),(t||0===t)&&(i+=t),i+="\n\n          ",n=e.ifEqual||a&&a.ifEqual,r={hash:{},inverse:_.noop,fn:_.program(17,m,l),data:l},t=n?n.call(a,a&&a.type,"checkbox",r):x.call(a,"ifEqual",a&&a.type,"checkbox",r),(t||0===t)&&(i+=t),i+='\n          <p data-hull-error="',(n=e.name)?t=n.call(a,{hash:{},data:l}):(n=a&&a.name,t=typeof n===q?n.call(a,{hash:{},data:l}):n),i+=E(t)+'" class="hull-form-field-error"></p>\n        </div>\n\n      '}function o(){return"required"}function h(a,l){var t,n,r="";return r+='\n            <label for="hull-form-',(n=e.name)?t=n.call(a,{hash:{},data:l}):(n=a&&a.name,t=typeof n===q?n.call(a,{hash:{},data:l}):n),r+=E(t)+'">',(n=e.label)?t=n.call(a,{hash:{},data:l}):(n=a&&a.label,t=typeof n===q?n.call(a,{hash:{},data:l}):n),r+=E(t)+'</label>\n            <input\n              type="',(n=e.type)?t=n.call(a,{hash:{},data:l}):(n=a&&a.type,t=typeof n===q?n.call(a,{hash:{},data:l}):n),r+=E(t)+'"\n              id="hull-form-',(n=e.name)?t=n.call(a,{hash:{},data:l}):(n=a&&a.name,t=typeof n===q?n.call(a,{hash:{},data:l}):n),r+=E(t)+'"\n              name="',(n=e.name)?t=n.call(a,{hash:{},data:l}):(n=a&&a.name,t=typeof n===q?n.call(a,{hash:{},data:l}):n),r+=E(t)+'"\n              value="',(n=e.value)?t=n.call(a,{hash:{},data:l}):(n=a&&a.value,t=typeof n===q?n.call(a,{hash:{},data:l}):n),r+=E(t)+'"\n              placeholder="',(n=e.placeholder)?t=n.call(a,{hash:{},data:l}):(n=a&&a.placeholder,t=typeof n===q?n.call(a,{hash:{},data:l}):n),r+=E(t)+'"\n              ',t=e["if"].call(a,a&&a.autocomplete,{hash:{},inverse:_.noop,fn:_.program(5,i,l),data:l}),(t||0===t)&&(r+=t),r+="\n              ",t=e["if"].call(a,a&&a.pattern,{hash:{},inverse:_.noop,fn:_.program(7,s,l),data:l}),(t||0===t)&&(r+=t),r+="\n              ",t=e["if"].call(a,a&&a.required,{hash:{},inverse:_.noop,fn:_.program(2,o,l),data:l}),(t||0===t)&&(r+=t),r+="\n              ",t=e["if"].call(a,a&&a.error,{hash:{},inverse:_.noop,fn:_.program(9,p,l),data:l}),(t||0===t)&&(r+=t),r+="\n            />\n          "}function i(a,l){var t,n,r="";return r+='autocomplete="',(n=e.autocomplete)?t=n.call(a,{hash:{},data:l}):(n=a&&a.autocomplete,t=typeof n===q?n.call(a,{hash:{},data:l}):n),r+=E(t)+'"'}function s(a,l){var t,n,r="";return r+='pattern="',(n=e.pattern)?t=n.call(a,{hash:{},data:l}):(n=a&&a.pattern,t=typeof n===q?n.call(a,{hash:{},data:l}):n),r+=E(t)+'"'}function p(a,l){var t,n,r="";return r+='data-error-message="',(n=e.error)?t=n.call(a,{hash:{},data:l}):(n=a&&a.error,t=typeof n===q?n.call(a,{hash:{},data:l}):n),r+=E(t)+'"'}function d(a,l){var t,n,r="";return r+='\n            <label for="hull-form-',(n=e.name)?t=n.call(a,{hash:{},data:l}):(n=a&&a.name,t=typeof n===q?n.call(a,{hash:{},data:l}):n),r+=E(t)+'">',(n=e.label)?t=n.call(a,{hash:{},data:l}):(n=a&&a.label,t=typeof n===q?n.call(a,{hash:{},data:l}):n),r+=E(t)+'</label>\n            <input\n              type="',(n=e.type)?t=n.call(a,{hash:{},data:l}):(n=a&&a.type,t=typeof n===q?n.call(a,{hash:{},data:l}):n),r+=E(t)+'"\n              id="hull-form-',(n=e.name)?t=n.call(a,{hash:{},data:l}):(n=a&&a.name,t=typeof n===q?n.call(a,{hash:{},data:l}):n),r+=E(t)+'"\n              data-hull-input="',(n=e.name)?t=n.call(a,{hash:{},data:l}):(n=a&&a.name,t=typeof n===q?n.call(a,{hash:{},data:l}):n),r+=E(t)+'"\n              name="',(n=e.name)?t=n.call(a,{hash:{},data:l}):(n=a&&a.name,t=typeof n===q?n.call(a,{hash:{},data:l}):n),r+=E(t)+'"\n              value="',(n=e.value)?t=n.call(a,{hash:{},data:l}):(n=a&&a.value,t=typeof n===q?n.call(a,{hash:{},data:l}):n),r+=E(t)+'"\n              placeholder="',(n=e.placeholder)?t=n.call(a,{hash:{},data:l}):(n=a&&a.placeholder,t=typeof n===q?n.call(a,{hash:{},data:l}):n),r+=E(t)+'"\n              ',t=e["if"].call(a,a&&a.autocomplete,{hash:{},inverse:_.noop,fn:_.program(5,i,l),data:l}),(t||0===t)&&(r+=t),r+="\n              ",t=e["if"].call(a,a&&a.pattern,{hash:{},inverse:_.noop,fn:_.program(7,s,l),data:l}),(t||0===t)&&(r+=t),r+="\n              ",t=e["if"].call(a,a&&a.required,{hash:{},inverse:_.noop,fn:_.program(2,o,l),data:l}),(t||0===t)&&(r+=t),r+="\n              ",t=e["if"].call(a,a&&a.error,{hash:{},inverse:_.noop,fn:_.program(9,p,l),data:l}),(t||0===t)&&(r+=t),r+="\n            />\n          "}function f(a,l){var t,n,r,h="";return h+='\n            <label for="hull-form-',(n=e.name)?t=n.call(a,{hash:{},data:l}):(n=a&&a.name,t=typeof n===q?n.call(a,{hash:{},data:l}):n),h+=E(t)+'">',(n=e.label)?t=n.call(a,{hash:{},data:l}):(n=a&&a.label,t=typeof n===q?n.call(a,{hash:{},data:l}):n),h+=E(t)+'</label>\n            <select\n            type="',(n=e.type)?t=n.call(a,{hash:{},data:l}):(n=a&&a.type,t=typeof n===q?n.call(a,{hash:{},data:l}):n),h+=E(t)+'"\n            id="hull-form-',(n=e.name)?t=n.call(a,{hash:{},data:l}):(n=a&&a.name,t=typeof n===q?n.call(a,{hash:{},data:l}):n),h+=E(t)+'"\n            data-hull-input="',(n=e.name)?t=n.call(a,{hash:{},data:l}):(n=a&&a.name,t=typeof n===q?n.call(a,{hash:{},data:l}):n),h+=E(t)+'"\n            name="',(n=e.name)?t=n.call(a,{hash:{},data:l}):(n=a&&a.name,t=typeof n===q?n.call(a,{hash:{},data:l}):n),h+=E(t)+'"\n            ',t=e["if"].call(a,a&&a.autocomplete,{hash:{},inverse:_.noop,fn:_.program(5,i,l),data:l}),(t||0===t)&&(h+=t),h+="\n            ",t=e["if"].call(a,a&&a.pattern,{hash:{},inverse:_.noop,fn:_.program(7,s,l),data:l}),(t||0===t)&&(h+=t),h+="\n            ",t=e["if"].call(a,a&&a.required,{hash:{},inverse:_.noop,fn:_.program(2,o,l),data:l}),(t||0===t)&&(h+=t),h+="\n            ",t=e["if"].call(a,a&&a.error,{hash:{},inverse:_.noop,fn:_.program(9,p,l),data:l}),(t||0===t)&&(h+=t),h+=">\n              ",r={hash:{},inverse:_.noop,fn:_.programWithDepth(14,c,l,a),data:l},(n=e.options)?t=n.call(a,r):(n=a&&a.options,t=typeof n===q?n.call(a,r):n),e.options||(t=H.call(a,t,{hash:{},inverse:_.noop,fn:_.programWithDepth(14,c,l,a),data:l})),(t||0===t)&&(h+=t),h+="\n            </select>\n          "}function c(a,l,t){var n,r,o,h="";return h+='\n                <option\n                  label="',(r=e.label)?n=r.call(a,{hash:{},data:l}):(r=a&&a.label,n=typeof r===q?r.call(a,{hash:{},data:l}):r),h+=E(n)+'"\n                  value="',(r=e.value)?n=r.call(a,{hash:{},data:l}):(r=a&&a.value,n=typeof r===q?r.call(a,{hash:{},data:l}):r),h+=E(n)+'"\n                  ',r=e.ifEqual||t&&t.ifEqual,o={hash:{},inverse:_.noop,fn:_.program(15,u,l),data:l},n=r?r.call(a,t&&t.value,a&&a.value,o):x.call(a,"ifEqual",t&&t.value,a&&a.value,o),(n||0===n)&&(h+=n),h+="\n                >",(r=e.value)?n=r.call(a,{hash:{},data:l}):(r=a&&a.value,n=typeof r===q?r.call(a,{hash:{},data:l}):r),h+=E(n)+"</option>\n              "}function u(){return"selected"}function m(a,l){var t,n,r="";return r+='\n            <input\n              type="',(n=e.type)?t=n.call(a,{hash:{},data:l}):(n=a&&a.type,t=typeof n===q?n.call(a,{hash:{},data:l}):n),r+=E(t)+'"\n              id="hull-form-',(n=e.name)?t=n.call(a,{hash:{},data:l}):(n=a&&a.name,t=typeof n===q?n.call(a,{hash:{},data:l}):n),r+=E(t)+'"\n              data-hull-input="',(n=e.name)?t=n.call(a,{hash:{},data:l}):(n=a&&a.name,t=typeof n===q?n.call(a,{hash:{},data:l}):n),r+=E(t)+'"\n              name="',(n=e.name)?t=n.call(a,{hash:{},data:l}):(n=a&&a.name,t=typeof n===q?n.call(a,{hash:{},data:l}):n),r+=E(t)+'"\n              ',t=e["if"].call(a,a&&a.value,{hash:{},inverse:_.noop,fn:_.program(18,v,l),data:l}),(t||0===t)&&(r+=t),r+='\n              placeholder="',(n=e.placeholder)?t=n.call(a,{hash:{},data:l}):(n=a&&a.placeholder,t=typeof n===q?n.call(a,{hash:{},data:l}):n),r+=E(t)+'"\n              ',t=e["if"].call(a,a&&a.autocomplete,{hash:{},inverse:_.noop,fn:_.program(5,i,l),data:l}),(t||0===t)&&(r+=t),r+="\n              ",t=e["if"].call(a,a&&a.pattern,{hash:{},inverse:_.noop,fn:_.program(7,s,l),data:l}),(t||0===t)&&(r+=t),r+="\n              ",t=e["if"].call(a,a&&a.required,{hash:{},inverse:_.noop,fn:_.program(2,o,l),data:l}),(t||0===t)&&(r+=t),r+="\n              ",t=e["if"].call(a,a&&a.error,{hash:{},inverse:_.noop,fn:_.program(9,p,l),data:l}),(t||0===t)&&(r+=t),r+='\n            />\n          <label for="hull-form-',(n=e.name)?t=n.call(a,{hash:{},data:l}):(n=a&&a.name,t=typeof n===q?n.call(a,{hash:{},data:l}):n),r+=E(t)+'">',(n=e.label)?t=n.call(a,{hash:{},data:l}):(n=a&&a.label,t=typeof n===q?n.call(a,{hash:{},data:l}):n),r+=E(t)+" </label>\n          "}function v(){return"checked"}this.compilerInfo=[4,">= 1.0.0"],e=this.merge(e,a.helpers),n=n||{};var y,g,b="",q="function",E=this.escapeExpression,_=this,x=e.helperMissing,H=e.blockHelperMissing;return b+='<div class="hull-registration">\n  <form id="',(g=e.formId)?y=g.call(l,{hash:{},data:n}):(g=l&&l.formId,y=typeof g===q?g.call(l,{hash:{},data:n}):g),b+=E(y)+'">\n    <fieldset>\n      ',y=e.each.call(l,l&&l.fields,{hash:{},inverse:_.noop,fn:_.program(1,r,n),data:n}),(y||0===y)&&(b+=y),b+='\n\n      <input type="submit" data-hull-action="submit" class="btn btn-primary" value="Register" />\n    </fieldset>\n  </form>\n</div>\n'},Hull.component("registration/form@hull",{type:"Hull",templates:["form","complete"],refreshEvents:["model.hull.me.change"],require:["h5f"],complete:!1,options:{editable:!1},defaultFields:[{type:"text",name:"name",label:"Name",value:"",required:!0,error:"Please enter your name",placeholder:"bob"},{type:"email",name:"email",label:"Email",value:"",required:!0,error:"Invalid Email",placeholder:"you@awesome.com"}],datasources:{fields:function(){var a=this.sandbox.data.api.model("app").get("extra");return a.profile_fields||this.defaultFields}},initialize:function(){this.formId="form_"+(new Date).getTime();var a=this.sandbox.util._;a.bindAll.apply(void 0,[this].concat(a.functions(this)))},validate:function(){this._ensureFormEl();var a=this.formEl.checkValidity();return a?a:(this.$el.find("[data-hull-input]").each(function(a,l){var e=$(l),t=(e.attr("id"),e.siblings("[data-hull-error]"));t.text(l.checkValidity()?"":e.data("errorMessage"))}),!1)},register:function(a){var l=this;me=this.sandbox.data.api.model("me"),this.loggedIn()&&this.api("me/profile","put",a,function(a){me.set("profile",a),l.render()})},beforeRender:function(a){a.formId=this.formId;var l=this.sandbox.util._.map(a.fields,function(a){return a.value=this._findFieldValue(a.name),a},this),e=a.me.profile||{},t=this.sandbox.util._.every(l,function(a){var l=e[a.name];return"checkbox"===a.type?l==a.value:!!l&&l===a.value});this.template=t?"complete":"form",this.fields=l},afterRender:function(){"form"===this.template&&(this._ensureFormEl(),H5F.setup(this.formEl,{validClass:"hull-form__input--valid",invalidClass:"hull-form__input--invalid",requiredClass:"hull-form__input--required",placeholderClass:"hull-form__input--placeholder"}))},actions:{edit:function(a){return a.preventDefault(),a.stopPropagation(),this.render("form"),!1},submit:function(a){if(a&&a.preventDefault(),!this.validate())return a&&a.stopPropagation(),a&&a.stopImmediatePropagation(),!1;var l=this.sandbox.util._.clone(this.fields),e={},t=this.$el;this.sandbox.util._.each(l,function(a){e[a.name]="checkbox"==a.type?t.find("#hull-form-"+a.name).is(":checked"):t.find("#hull-form-"+a.name).val()}),this.register(e)}},_findFieldValue:function(a){var l=this.data.me.toJSON()||{},e=this.sandbox.util._.reduce(l.identities,this.sandbox.util._.bind(function(a,l){return this.sandbox.util._.extend(a,l)},this),{});return l.profile=l.profile||{},e=e||{},l.profile[a]||l[a]||e[a]},_ensureFormEl:function(){this.formEl=this.formEl||document.getElementById(this.formId)}});