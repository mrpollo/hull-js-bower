this.Hull=this.Hull||{},this.Hull.templates=this.Hull.templates||{},this.Hull.templates._default=this.Hull.templates._default||{},Hull.templates._default["admin/user_profile/user_profile"]=function(n,a,e,t,s){function l(n,a){var t,s,l,h="";return h+='\n  <div class="media user-header">\n    ',t=e["if"].call(n,(t=n&&n.user,null==t||t===!1?t:t.picture),{hash:{},inverse:S.noop,fn:S.program(2,i,a),data:a}),(t||0===t)&&(h+=t),h+="\n\n    <div class='media-body'>\n      <h4 class='media-heading'>\n        "+B((t=n&&n.user,t=null==t||t===!1?t:t.name,typeof t===x?t.apply(n):t))+'\n        <small class="muted">'+B((t=n&&n.user,t=null==t||t===!1?t:t.email,typeof t===x?t.apply(n):t))+'</small>\n      </h4>\n\n      <div class="admin-infos">\n        <dl>\n          ',t=e["if"].call(n,(t=n&&n.user,null==t||t===!1?t:t.email),{hash:{},inverse:S.noop,fn:S.program(4,d,a),data:a}),(t||0===t)&&(h+=t),h+="\n          ",t=e["if"].call(n,(t=n&&n.user,null==t||t===!1?t:t.username),{hash:{},inverse:S.noop,fn:S.program(6,r,a),data:a}),(t||0===t)&&(h+=t),h+="\n          ",t=e.each.call(n,(t=n&&n.user,null==t||t===!1?t:t.identities),{hash:{},inverse:S.noop,fn:S.program(8,o,a),data:a}),(t||0===t)&&(h+=t),h+='\n        </dl>\n      </div>\n\n    </div>\n\n  </div>\n\n  <div class="row-fluid">\n\n    <div class="cell-6">\n\n      <div class="admin-infos admin-infos-permissions">\n        <header>\n          <h5>Permissions</h5>\n        </header>\n        <dl>\n          <dt>Role:</dt>\n          <dd>\n            <div class="dropdown">\n              <a href="#" class="dropdown-toggle" data-toggle="dropdown">\n                ',t=e["if"].call(n,(t=n&&n.user,null==t||t===!1?t:t.is_admin),{hash:{},inverse:S.program(15,c,a),fn:S.program(13,u,a),data:a}),(t||0===t)&&(h+=t),h+='\n                <span class="caret"></span>\n              </a>\n              <ul class="dropdown-menu">\n                <li><a href="#" data-hull-action="promote" data-hull-role="normal">User</a></li>\n                <li><a href="#" data-hull-action="promote" data-hull-role="admin">Admin</a></li>\n              </ul>\n            </div>\n          </dd>\n        </dl>\n      </div>\n\n    </div>\n\n    <div class="cell-6 admin-infos">\n        <header>\n          <h5>Stats</h5>\n        </header>\n      ',s=e.key_value||n&&n.key_value,l={hash:{},inverse:S.noop,fn:S.program(17,f,a),data:a},t=s?s.call(n,(t=n&&n.user,null==t||t===!1?t:t.stats),l):P.call(n,"key_value",(t=n&&n.user,null==t||t===!1?t:t.stats),l),(t||0===t)&&(h+=t),h+="\n\n    </div>\n\n  </div>\n\n  ",t=e.unless.call(n,(t=n&&n.org,null==t||t===!1?t:t["public"]),{hash:{},inverse:S.noop,fn:S.program(19,m,a),data:a}),(t||0===t)&&(h+=t),h+="\n\n\n  ",t=e["if"].call(n,n&&n.userHasProfiles,{hash:{},inverse:S.noop,fn:S.program(24,y,a),data:a}),(t||0===t)&&(h+=t),h+="\n\n  ",t=e["if"].call(n,n&&n.badges,{hash:{},inverse:S.noop,fn:S.program(28,H,a),data:a}),(t||0===t)&&(h+=t),h+="\n\n"}function i(n){var a,e="";return e+='\n      <div class="pull-left">\n        <img class=\'img-rounded\' src="'+B((a=n&&n.user,a=null==a||a===!1?a:a.picture,typeof a===x?a.apply(n):a))+'" width="50" height="50"/>\n      </div>\n    '}function d(n){var a,e="";return e+="\n            <dt>Email</dt>\n            <dd>"+B((a=n&&n.user,a=null==a||a===!1?a:a.email,typeof a===x?a.apply(n):a))+"</dd>\n          "}function r(n){var a,e="";return e+="\n            <dt>Username</dt>\n            <dd>"+B((a=n&&n.user,a=null==a||a===!1?a:a.username,typeof a===x?a.apply(n):a))+"</dd>\n          "}function o(n,a){var t,s,l,i="";return i+="\n            <dt>"+B((s=e.humanize||n&&n.humanize,l={hash:{},data:a},s?s.call(n,n&&n.provider,l):P.call(n,"humanize",n&&n.provider,l)))+":</dt>\n            <dd>",t=e["if"].call(n,n&&n.login,{hash:{},inverse:S.program(11,p,a),fn:S.program(9,h,a),data:a}),(t||0===t)&&(i+=t),i+="</dd>\n          "}function h(n,a){var t,s;return(s=e.login)?t=s.call(n,{hash:{},data:a}):(s=n&&n.login,t=typeof s===x?s.call(n,{hash:{},data:a}):s),B(t)}function p(n,a){var t,s;return(s=e.email)?t=s.call(n,{hash:{},data:a}):(s=n&&n.email,t=typeof s===x?s.call(n,{hash:{},data:a}):s),B(t)}function u(){return"\n                  Admin\n                "}function c(){return"\n                  User\n                "}function f(n,a){var t,s,l="";return l+="\n        <dl>\n          <dt>"+B((t=e.humanize||n&&n.humanize,s={hash:{},data:a},t?t.call(n,n&&n.key,s):P.call(n,"humanize",n&&n.key,s)))+"</dt>\n          <dd>"+B((t=e.json||n&&n.json,s={hash:{},data:a},t?t.call(n,n&&n.value,s):P.call(n,"json",n&&n.value,s)))+"</dd>\n        </dl>\n      "}function m(n,a){var t,s="";return s+='\n    <div class="admin-infos admin-infos-approve">\n      ',t=e["if"].call(n,(t=n&&n.user,null==t||t===!1?t:t.approved),{hash:{},inverse:S.program(22,g,a),fn:S.program(20,v,a),data:a}),(t||0===t)&&(s+=t),s+="\n    </div>\n  "}function v(){return'\n        <button class="btn btn-block" data-hull-action="unapprove">Unapprove</button>\n      '}function g(){return'\n        <button class="btn btn-block" data-hull-action="approve">Approve</button>\n      '}function y(n,a){var t,s="";return s+='\n    <h3>Profiles</h3>\n    <div class="admin-infos">\n      ',t=e.each.call(n,(t=n&&n.user,null==t||t===!1?t:t.profiles),{hash:{},inverse:S.noop,fn:S.program(25,b,a),data:a}),(t||0===t)&&(s+=t),s+="\n    </div>\n  "}function b(n,a){var t,s="";return s+="\n        <header>\n          <h5>"+B((t=null==a||a===!1?a:a.key,typeof t===x?t.apply(n):t))+":</h5>\n        </header>\n        <dl>\n          ",t=e.each.call(n,n,{hash:{},inverse:S.noop,fn:S.program(26,_,a),data:a}),(t||0===t)&&(s+=t),s+="\n        </dl>\n      "}function _(n,a){var e,t="";return t+="\n            <dt>"+B((e=null==a||a===!1?a:a.key,typeof e===x?e.apply(n):e))+":</dt>\n            <dd>"+B(typeof n===x?n.apply(n):n)+"</dd>\n          "}function H(n,a){var t,s,l,i="";return i+="\n  <h3>Badges</h3>\n  ",l={hash:{},inverse:S.noop,fn:S.program(29,k,a),data:a},(s=e.badges)?t=s.call(n,l):(s=n&&n.badges,t=typeof s===x?s.call(n,l):s),e.badges||(t=j.call(n,t,{hash:{},inverse:S.noop,fn:S.program(29,k,a),data:a})),(t||0===t)&&(i+=t),i+="\n  "}function k(n,a){var t,s,l="";return l+='\n  <div class="admin-infos">\n    <header>\n      <h5>\n        <small class="pull-right">\n          <a class="btn-link" data-hull-action="deleteBadge" data-hull-id="',(s=e.id)?t=s.call(n,{hash:{},data:a}):(s=n&&n.id,t=typeof s===x?s.call(n,{hash:{},data:a}):s),l+=B(t)+'">\n            <i class="icon-trash"></i> delete\n          </a>\n        </small>\n        [',(s=e.achievement_type)?t=s.call(n,{hash:{},data:a}):(s=n&&n.achievement_type,t=typeof s===x?s.call(n,{hash:{},data:a}):s),l+=B(t)+"] ",(s=e.achievement_name)?t=s.call(n,{hash:{},data:a}):(s=n&&n.achievement_name,t=typeof s===x?s.call(n,{hash:{},data:a}):s),l+=B(t)+"\n      </h5>\n    </header>\n    <dl>\n      <dt>created_at:</dt>\n      <dd>",(s=e.created_at)?t=s.call(n,{hash:{},data:a}):(s=n&&n.created_at,t=typeof s===x?s.call(n,{hash:{},data:a}):s),l+=B(t)+"</dd>\n      <dt>updated_at:</dt>\n      <dd>",(s=e.updated_at)?t=s.call(n,{hash:{},data:a}):(s=n&&n.updated_at,t=typeof s===x?s.call(n,{hash:{},data:a}):s),l+=B(t)+"</dd>\n      <dt>Score:</dt>\n      <dd>",(s=e.score)?t=s.call(n,{hash:{},data:a}):(s=n&&n.score,t=typeof s===x?s.call(n,{hash:{},data:a}):s),l+=B(t)+"</dd>\n      <dt>Best Score:</dt>\n      <dd>",(s=e.best_score)?t=s.call(n,{hash:{},data:a}):(s=n&&n.best_score,t=typeof s===x?s.call(n,{hash:{},data:a}):s),l+=B(t)+"</dd>\n      <dt># attempts:</dt>\n      <dd>"+B((t=n&&n.stats,t=null==t||t===!1?t:t.attempts,typeof t===x?t.apply(n):t))+"</dd>\n    </dl>\n  </div>\n  "}function U(){return'\n  <div class="admin-empty text-center">\n    <div class="admin-empty-wrapper">\n      <span class="admin-empty-icon">&#9785;</span>\n      <h4>User not found</h4>\n    </div>\n  </div>\n'}this.compilerInfo=[4,">= 1.0.0"],e=this.merge(e,n.helpers),s=s||{};var w,z="",x="function",B=this.escapeExpression,P=e.helperMissing,S=this,j=e.blockHelperMissing;return w=e["if"].call(a,a&&a.user,{hash:{},inverse:S.program(31,U,s),fn:S.program(1,l,s),data:s}),(w||0===w)&&(z+=w),z+="\n"},Hull.component("admin/user_profile@hull",{type:"Hull",templates:["user_profile"],datasources:{user:function(){return this.options.id?this.api({provider:"admin@"+this.options.namespace,path:this.options.id},{fields:"user.profiles"}):void 0},badges:function(){return this.options.id?this.api({provider:"admin@"+this.options.namespace,path:this.options.id+"/badges"}):void 0}},initialize:function(){this.sandbox.on("hull.user.select",this.renderUser,this)},beforeRender:function(n){n.user&&(n.userHasProfiles=!this.sandbox.util._.isEmpty(n.user.profiles))},actions:{promote:function(n,a){this.promoteUser(a.data.role)},approve:function(){var n=this;this.api(this.data.user.id+"/approve","post").then(function(){n.render()})},unapprove:function(){var n=this;this.api(this.data.user.id+"/unapprove","post").then(function(){n.render()})},deleteBadge:function(n,a){var e=this;confirm("Sure ?")&&this.api({path:a.data.id,provider:"admin@"+this.options.namespace},"delete",function(){e.render()})}},renderUser:function(n){var a=this.data.user;a&&a.id===n||(this.options.id=n,this.user=n,this.render())},promoteUser:function(n){var a="admin"===n?"post":"delete",e=this;this.api({provider:"admin@"+this.options.namespace,path:"admins/"+this.data.user.id},a).then(function(){e.render()})}});