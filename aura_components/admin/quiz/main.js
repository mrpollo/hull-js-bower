this.Hull=this.Hull||{},this.Hull.templates=this.Hull.templates||{},this.Hull.templates._default=this.Hull.templates._default||{},Hull.templates._default["admin/quiz/admin"]=function(e,a,n,t,i){function s(e,a){var t,i,s="";return s+='\n        <li data-hull-action="selectQuiz" data-hull-quiz-id="',(i=n.id)?t=i.call(e,{hash:{},data:a}):(i=e&&e.id,t=typeof i===c?i.call(e,{hash:{},data:a}):i),s+=p(t)+'"><a href="#">',(i=n.name)?t=i.call(e,{hash:{},data:a}):(i=e&&e.name,t=typeof i===c?i.call(e,{hash:{},data:a}):i),s+=p(t)+"</a></li>\n      "}function l(e,a){var i,s="";return s+="\n      ",i=f.invokePartial(t["admin/quiz/form"],"admin/quiz/form",e,n,t,a),(i||0===i)&&(s+=i),s+="\n    "}function u(){return'\n      <h2 class="well">Select a quiz to start playing...</h2>\n    '}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),t=this.merge(t,e.partials),i=i||{};var r,h,o,d="",c="function",p=this.escapeExpression,f=this,m=n.blockHelperMissing;return d+='<div class="row">\n  <div class="span4">\n    <h4>Available Quizzes</h4>\n    <ul class="nav nav-pills nav-stacked">\n      ',o={hash:{},inverse:f.noop,fn:f.program(1,s,i),data:i},(h=n.achievements)?r=h.call(a,o):(h=a&&a.achievements,r=typeof h===c?h.call(a,o):h),n.achievements||(r=m.call(a,r,{hash:{},inverse:f.noop,fn:f.program(1,s,i),data:i})),(r||0===r)&&(d+=r),d+='\n    </ul>\n\n    <button data-hull-action="selectQuiz" class="btn">Create a new Quiz</button>\n  </div>\n\n  <div class="span8">\n    ',r=n["if"].call(a,a&&a.quiz,{hash:{},inverse:f.program(5,u,i),fn:f.program(3,l,i),data:i}),(r||0===r)&&(d+=r),d+="\n  </div>\n</div>\n"},Hull.templates._default["admin/quiz/form"]=function(e,a,n,t,i){function s(e,a){var t,i,s="";return s+='\n<h6>Embed code</h6>\n<pre class="code">',(i=n.embedCode)?t=i.call(e,{hash:{},data:a}):(i=e&&e.embedCode,t=typeof i===m?i.call(e,{hash:{},data:a}):i),s+=q(t)+"</pre>\n"}function l(e,a){var t,i,s="";return s+='\n<form class="form js-hull-quiz-form">\n  <fieldset>\n    <input type="text" class="input-block-level" name="name" value="',(i=n.name)?t=i.call(e,{hash:{},data:a}):(i=e&&e.name,t=typeof i===m?i.call(e,{hash:{},data:a}):i),s+=q(t)+'" placeholder="Name" required="true">\n    <textarea class="input-block-level" name="description" placeholder="Description">',(i=n.description)?t=i.call(e,{hash:{},data:a}):(i=e&&e.description,t=typeof i===m?i.call(e,{hash:{},data:a}):i),s+=q(t)+'</textarea>\n  </fieldset>\n\n  <ul class="unstyled">\n  ',t=n.each.call(e,e&&e.questions,{hash:{},inverse:v.noop,fn:v.program(4,u,a),data:a}),(t||0===t)&&(s+=t),s+='\n</ul>\n\n<hr />\n\n<a data-hull-action="addQuestion" class="btn">\n  <i class="icon-plus"></i>\n  Add a Question\n</a>\n\n<hr />\n\n<input type="submit" value="',t=n["if"].call(e,e&&e.isNew,{hash:{},inverse:v.program(9,o,a),fn:v.program(7,h,a),data:a}),(t||0===t)&&(s+=t),s+='" class="btn btn-primary btn-block" />\n\n</form>\n'}function u(e,a){var t,i,s="";return s+='\n  <li>\n    <hr />\n\n    <h3>\n      <span class="pull-right">\n        <a class="btn btn-danger" data-hull-action="deleteQuestion" data-hull-question-index="'+q((t=null==a||a===!1?a:a.index,typeof t===m?t.apply(e):t))+'">\n          <i class="icon-trash"></i>\n          Delete\n        </a>\n      </span>\n\n      Question '+q((t=null==a||a===!1?a:a.index,typeof t===m?t.apply(e):t))+'\n    </h3>\n\n    <input type="text" class="input-block-level" name="questions['+q((t=null==a||a===!1?a:a.index,typeof t===m?t.apply(e):t))+'][ref]" value="',(i=n.ref)?t=i.call(e,{hash:{},data:a}):(i=e&&e.ref,t=typeof i===m?i.call(e,{hash:{},data:a}):i),s+=q(t)+'" placeholder="Ref" required="true">\n    <input type="text" class="input-block-level" name="questions['+q((t=null==a||a===!1?a:a.index,typeof t===m?t.apply(e):t))+'][name]" value="',(i=n.name)?t=i.call(e,{hash:{},data:a}):(i=e&&e.name,t=typeof i===m?i.call(e,{hash:{},data:a}):i),s+=q(t)+'" placeholder="Type a Question..." required="true">\n\n    <textarea type="text" class="input-block-level" name="questions['+q((t=null==a||a===!1?a:a.index,typeof t===m?t.apply(e):t))+'][description]">',(i=n.description)?t=i.call(e,{hash:{},data:a}):(i=e&&e.description,t=typeof i===m?i.call(e,{hash:{},data:a}):i),s+=q(t)+'</textarea>\n    <h5>Answers</h5>\n\n    <ul class="unstyled">\n    ',t=n.each.call(e,e&&e.answers,{hash:{},inverse:v.noop,fn:v.program(5,r,a),data:a}),(t||0===t)&&(s+=t),s+='\n      <li>\n        <a data-hull-action="addAnswer" data-hull-question-index="'+q((t=null==a||a===!1?a:a.index,typeof t===m?t.apply(e):t))+'" class="btn">\n          <i class="icon-plus"></i>\n          Add a Answer\n        </a>\n      </li>\n    </ul>\n  </li>\n  '}function r(e,a){var t,i,s="";return s+='\n      <li>\n        <input type="hidden" name="questions[',(i=n.questionIndex)?t=i.call(e,{hash:{},data:a}):(i=e&&e.questionIndex,t=typeof i===m?i.call(e,{hash:{},data:a}):i),s+=q(t)+"][answers]["+q((t=null==a||a===!1?a:a.index,typeof t===m?t.apply(e):t))+'][questionIndex]" value="',(i=n.questionIndex)?t=i.call(e,{hash:{},data:a}):(i=e&&e.questionIndex,t=typeof i===m?i.call(e,{hash:{},data:a}):i),s+=q(t)+'">\n\n        <input type="text" class="input-small" name="questions[',(i=n.questionIndex)?t=i.call(e,{hash:{},data:a}):(i=e&&e.questionIndex,t=typeof i===m?i.call(e,{hash:{},data:a}):i),s+=q(t)+"][answers]["+q((t=null==a||a===!1?a:a.index,typeof t===m?t.apply(e):t))+'][ref]" value="',(i=n.ref)?t=i.call(e,{hash:{},data:a}):(i=e&&e.ref,t=typeof i===m?i.call(e,{hash:{},data:a}):i),s+=q(t)+'" placeholder="Ref" required="true">\n        <input type="text" class="input-large" name="questions[',(i=n.questionIndex)?t=i.call(e,{hash:{},data:a}):(i=e&&e.questionIndex,t=typeof i===m?i.call(e,{hash:{},data:a}):i),s+=q(t)+"][answers]["+q((t=null==a||a===!1?a:a.index,typeof t===m?t.apply(e):t))+'][name]" value="',(i=n.name)?t=i.call(e,{hash:{},data:a}):(i=e&&e.name,t=typeof i===m?i.call(e,{hash:{},data:a}):i),s+=q(t)+'" placeholder="Type an Answer..." required="true">\n        <input type="text" class="input-small" name="questions[',(i=n.questionIndex)?t=i.call(e,{hash:{},data:a}):(i=e&&e.questionIndex,t=typeof i===m?i.call(e,{hash:{},data:a}):i),s+=q(t)+"][answers]["+q((t=null==a||a===!1?a:a.index,typeof t===m?t.apply(e):t))+'][weight]" value="',(i=n.weight)?t=i.call(e,{hash:{},data:a}):(i=e&&e.weight,t=typeof i===m?i.call(e,{hash:{},data:a}):i),s+=q(t)+'" placeholder="Weight" required="true" pattern="\\d*">\n      </li>\n    '}function h(){return"Create"}function o(){return"Update"}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var d,c,p,f="",m="function",q=this.escapeExpression,v=this,y=n.blockHelperMissing;return f+="<h2>"+q((d=a&&a.quiz,d=null==d||d===!1?d:d.name,typeof d===m?d.apply(a):d))+"</h2>\n\n",d=n["if"].call(a,a&&a.embedCode,{hash:{},inverse:v.noop,fn:v.program(1,s,i),data:i}),(d||0===d)&&(f+=d),f+="\n\n",p={hash:{},inverse:v.noop,fn:v.program(3,l,i),data:i},(c=n.quiz)?d=c.call(a,p):(c=a&&a.quiz,d=typeof c===m?c.call(a,p):c),n.quiz||(d=y.call(a,d,{hash:{},inverse:v.noop,fn:v.program(3,l,i),data:i})),(d||0===d)&&(f+=d),f+="\n"},Hull.component("admin/quiz@hull",{templates:["admin","form"],datasources:{achievements:{path:"app/achievements",params:{where:{_type:"Quiz"}}}},require:["backbone"],events:{"submit form":"submitQuiz"},actions:{selectQuiz:function(e,a){var n,t=this.require("backbone").Model;if(n=null!=a.data.quizId?this.data.achievements.get(a.data.quizId):new t,this.currentQuiz&&this.stopListening(this.currentQuiz),n){this.currentQuiz=n;var i=this;this.listenTo(this.currentQuiz,"change",function(){i.render()}),this.render()}},addQuestion:function(){this.changeForm();var e=this.currentQuiz.get("questions")||[];e.push(this.generateQuestion()),this.currentQuiz.set("questions",e),this.currentQuiz.trigger("change")},addAnswer:function(e,a){this.changeForm();var n=this.currentQuiz.get("questions")[a.data.questionIndex];n.answers=n.answers||[],n.answers.push(this.generateAnswer(a.data.questionIndex)),this.currentQuiz.trigger("change")},deleteQuestion:function(e,a){var n=this.sandbox.util._.reject(this.currentQuiz.get("questions"),function(e,n){return n==a.data.questionIndex});this.currentQuiz.set("questions",n)}},changeForm:function(){var e=this.sandbox.dom.getFormData(this.$form);return this.currentQuiz.set(e),e},submitQuiz:function(e){e.preventDefault();var a,n=this,t=this.changeForm();this.currentQuiz.isNew()?(t.type="quiz",a=this.api("app/achievements",t,"post")):a=this.api(this.currentQuiz.id,t,"put"),a.then(function(){n.render(),alert("Your quiz has been updated.")})},beforeRender:function(e){var a=this.sandbox.util._;this.currentQuiz&&(e.quiz=this.currentQuiz.toJSON(),a.each(e.quiz.questions,function(e,n){a.each(e.answers,function(e){e.questionIndex=n})}),e.quiz.isNew=this.currentQuiz.isNew(),e.quiz.isNew||(e.embedCode='<div data-hull-component="games/quiz@hull" data-hull-id="'+e.quiz.id+'"></div>'))},afterRender:function(e){e.quiz&&e.quiz.id&&this.$find('[data-hull-quiz-id="'+e.quiz.id+'"]').addClass("active"),this.$form=this.$(".js-hull-quiz-form")},generateQuestion:function(){return{answers:[]}},generateAnswer:function(e){return{questionIndex:e}}});