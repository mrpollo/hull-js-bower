this.Hull=this.Hull||{},this.Hull.templates=this.Hull.templates||{},this.Hull.templates._default=this.Hull.templates._default||{},Hull.templates._default["lists/membership/header"]=function(t,e,i,n,s){return this.compilerInfo=[4,">= 1.0.0"],i=this.merge(i,t.helpers),s=s||{},'<div class="new">\n  <form>\n    <div class="input-append">\n      <input name="name" id="name" class="input-medium" type="text"/>\n      <button class="btn" href="#" type="submit">Create</button>\n    </div>\n  </form>\n</div>\n<ul class="lists nav nav-tabs nav-stacked">\n</ul>\n\n'},Hull.templates._default["lists/membership/items"]=function(t,e,i,n,s){function a(t,e){var n,s,a="";return a+='\n  <li>\n    <a href="#" data-hull-list-id=\'',(s=i.id)?n=s.call(t,{hash:{},data:e}):(s=t&&t.id,n=typeof s===o?s.call(t,{hash:{},data:e}):s),a+=d(n)+"'>\n      <span class=\"pull-right listed ",(s=i.cssClass)?n=s.call(t,{hash:{},data:e}):(s=t&&t.cssClass,n=typeof s===o?s.call(t,{hash:{},data:e}):s),a+=d(n)+'">✔</span>\n      <span>☰</span>\n      ',(s=i.name)?n=s.call(t,{hash:{},data:e}):(s=t&&t.name,n=typeof s===o?s.call(t,{hash:{},data:e}):s),a+=d(n)+"\n    </a>\n  </li>\n"}this.compilerInfo=[4,">= 1.0.0"],i=this.merge(i,t.helpers),s=s||{};var l,r="",o="function",d=this.escapeExpression,h=this;return l=i.each.call(e,e&&e.elements,{hash:{},inverse:h.noop,fn:h.program(1,a,s),data:s}),(l||0===l)&&(r+=l),r+="\n"},Hull.templates._default["lists/membership/loggedOut"]=function(t,e,i,n,s){return this.compilerInfo=[4,">= 1.0.0"],i=this.merge(i,t.helpers),s=s||{},'<ul>\n  <li>\n    <div data-hull-component="login/button@hull"></div>\n  </li>\n</ul>\n'},Hull.templates._default["lists/membership/main"]=function(t,e,i,n,s){return this.compilerInfo=[4,">= 1.0.0"],i=this.merge(i,t.helpers),s=s||{},'<div data-hull-toggle class="btn btn-mini">☰</div>\n'},Hull.component("lists/membership@hull",{type:"Hull",templates:["main","items","loggedOut","header"],refreshEvents:["model.hull.me.change"],requiredOptions:["id"],datasources:{lists:function(){"use strict";var t=this.sandbox.util._;return!this.loggedIn()&&[]||this.api("me/lists").then(function(e){return t.map(e,function(t){return{id:t.id,name:t.name}})})},listedIn:function(){"use strict";var t=this.sandbox.util._;return!this.loggedIn()&&!0||this.api(this.options.id+"/listed_in").then(function(e){return t.pluck(e,"id")})}},initialize:function(){"use strict";if(!this.sandbox.util._.isFunction(this.$el.popover))throw new Error("The component "+this.componentName+" requires jQuery.popover.")},afterRender:function(){"use strict";var t=this.sandbox.util._,e=this.$el.find("[data-hull-toggle]");e.popover({title:"Add to List",html:!0,placement:"bottom",content:"",container:"body"}),e.on("show",this.sandbox.util._.bind(this.renderPopover,this)),this.sandbox.dom.find(document.body).on("click",t.bind(function(t){0===this.getContentTip().find(t.target).length&&-1===e.index(t.target)&&e.popover("hide")},this))},createList:function(t){"use strict";var e=this.sandbox.util._;this.api.post("me/lists",t).then(e.bind(function(t){this.data.lists.unshift({id:t.id,name:t.name}),this.addToList(t.id).then(e.bind(this.refreshElements,this)),this.getContentTip().find("input").val("")},this))},isItemInList:function(t){"use strict";return this.data.listedIn.indexOf(t)>-1},removeFromList:function(t){"use strict";var e=this.sandbox.util._;return this.toggleIn(t,"del").then(e.bind(function(){this.data.listedIn=e.filter(this.data.listedIn,function(e){return t!==e})},this))},addToList:function(t){"use strict";var e=this.sandbox.util._;return this.toggleIn(t,"add").then(e.bind(function(){this.data.listedIn.unshift(t),this.data.listedIn=e.uniq(this.data.listedIn)},this))},toggleIn:function(t,e){"use strict";var i={add:"post",del:"delete"};return this.api(t+"/items/"+this.options.id,i[e])},renderPopover:function(){"use strict";var t=this.getContentTip(),e=t.find(".popover-content");if(this.loggedIn()){var i=this.renderTemplate("header",{id:this.id});e.html(i),this.refreshElements()}else e.html(this.renderTemplate("loggedOut"));this.sandbox.start(e,{reset:!0});var n=this;t.on("click",".lists a",function(t){t.preventDefault();var e=n.sandbox.util._,i=n.sandbox.dom.find(t.currentTarget).data("hull-list-id"),s=n.isItemInList(i)?"removeFromList":"addToList",a=n[s](i);a.then(e.bind(n.refreshElements,n))}),t.on("submit","form",function(t){t.preventDefault();var e=n.sandbox.dom.getFormData(t.currentTarget);return n.createList(e)})},refreshElements:function(){"use strict";var t=this.getContentTip(),e=t.find(".popover-content .lists"),i=this.sandbox.util._;this.$find("input[type=text][name=name]").val(""),i.each(this.data.lists,i.bind(function(t){t.cssClass=this.isItemInList(t.id)?"":"hidden"},this)),e.html(this.renderTemplate("items",{elements:this.data.lists}))},getContentTip:function(){return this.$el.find("[data-hull-toggle]").data("popover").tip()}});