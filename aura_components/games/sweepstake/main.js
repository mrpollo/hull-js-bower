this.Hull=this.Hull||{},this.Hull.templates=this.Hull.templates||{},this.Hull.templates._default=this.Hull.templates._default||{},Hull.templates._default["games/sweepstake/buttons"]=function(t,e,a,n,s){function i(){return'\n  <button class="btn btn-primary" data-hull-action="play">Play</button>\n'}function l(t,e){var n,s="";return s+="\n  ",n=a.each.call(t,t&&t.authProviders,{hash:{},inverse:c.noop,fn:c.program(4,r,e),data:e}),(n||0===n)&&(s+=n),s+="\n"}function r(t,e){var n,s,i="";return i+='\n    <button class="btn" data-hull-action="play" data-hull-provider='+p(typeof t===u?t.apply(t):t)+">Play with "+p((n=a.capitalize||t&&t.capitalize,s={hash:{},data:e},n?n.call(t,t,s):d.call(t,"capitalize",t,s)))+"</button>\n  "}this.compilerInfo=[4,">= 1.0.0"],a=this.merge(a,t.helpers),s=s||{};var h,o="",u="function",p=this.escapeExpression,d=a.helperMissing,c=this;return h=a["if"].call(e,e&&e.loggedIn,{hash:{},inverse:c.program(3,l,s),fn:c.program(1,i,s),data:s}),(h||0===h)&&(o+=h),o+="\n"},Hull.templates._default["games/sweepstake/ended"]=function(t,e,a,n,s){return this.compilerInfo=[4,">= 1.0.0"],a=this.merge(a,t.helpers),s=s||{},'<div class="hull-instant hull-instant--ended">\n  <h1>The Game is over.</h1>\n  <p class="lead">Come back next time!</p>\n</div>\n'},Hull.templates._default["games/sweepstake/intro"]=function(t,e,a,n,s){this.compilerInfo=[4,">= 1.0.0"],a=this.merge(a,t.helpers),n=this.merge(n,t.partials),s=s||{};var i,l="",r="function",h=this.escapeExpression,o=this;return l+='<div class="hull-instant hull-instant--intro">\n  <h1>'+h((i=e&&e.achievement,i=null==i||i===!1?i:i.name,typeof i===r?i.apply(e):i))+'</h1>\n  <p class="lead">'+h((i=e&&e.achievement,i=null==i||i===!1?i:i.description,typeof i===r?i.apply(e):i))+"</p>\n  ",i=o.invokePartial(n["games/sweepstake/buttons"],"games/sweepstake/buttons",e,a,n,s),(i||0===i)&&(l+=i),l+="\n</div>\n"},Hull.templates._default["games/sweepstake/lost"]=function(t,e,a,n,s){return this.compilerInfo=[4,">= 1.0.0"],a=this.merge(a,t.helpers),s=s||{},'<div class="hull-instant hull-instant--lost">\n  <div class="hull-instant-result">\n    <h1>You Lose...</h1>\n    <p class="lead">Come back tomorrow!</p>\n  </div>\n</div>\n'},Hull.templates._default["games/sweepstake/played"]=function(t,e,a,n,s){return this.compilerInfo=[4,">= 1.0.0"],a=this.merge(a,t.helpers),s=s||{},'<div class="hull-instant hull-instant--played">\n  <div class="hull-instant-result">\n    <h1>You\'ve already played today!</h1>\n    <p class="lead">Come back tomorrow!</p>\n  </div>\n</div>\n'},Hull.templates._default["games/sweepstake/unstarted"]=function(t,e,a,n,s){return this.compilerInfo=[4,">= 1.0.0"],a=this.merge(a,t.helpers),s=s||{},'<div class="hull-instant hull-instant--unstarted">\n  <h1>The Game hasn\'t started yet.</h1>\n  <p class="lead">Come back later!</p>\n</div>\n'},Hull.templates._default["games/sweepstake/won"]=function(t,e,a,n,s){function i(t,e){var n,s="";return s+='\n    <div class="hull-instant-result">\n      <h1>You won a '+u((n=t&&t.prize,n=null==n||n===!1?n:n.name,typeof n===o?n.apply(t):n))+" !</h1>\n      ",n=a["if"].call(t,(n=t&&t.prize,null==n||n===!1?n:n.description),{hash:{},inverse:p.noop,fn:p.program(2,l,e),data:e}),(n||0===n)&&(s+=n),s+="\n    </div>\n  "}function l(t){var e,a="";return a+='\n        <p class="lead">'+u((e=t&&t.prize,e=null==e||e===!1?e:e.description,typeof e===o?e.apply(t):e))+"</p>\n      "}this.compilerInfo=[4,">= 1.0.0"],a=this.merge(a,t.helpers),s=s||{};var r,h="",o="function",u=this.escapeExpression,p=this;return h+='<div class="hull-instant hull-instant--won">\n  ',r=a["with"].call(e,(r=e&&e.badge,null==r||r===!1?r:r.data),{hash:{},inverse:p.noop,fn:p.program(1,i,s),data:s}),(r||0===r)&&(h+=r),h+="\n</div>\n"},Hull.templates._default["games/sweepstake/working"]=function(t,e,a,n,s){return this.compilerInfo=[4,">= 1.0.0"],a=this.merge(a,t.helpers),s=s||{},'<div class="hull-instant hull-instant--wokrking">\n  <h1>Loading, please wait...</h1>\n</div>\n'},Hull.component("games/sweepstake@hull",{type:"Hull",templates:["intro","buttons","working","won","lost","played","unstarted","ended"],trackingData:function(){var t={type:"instant_win"},e=this.data.achievement;return e&&e.get&&(t.name=e.get("name")),t},refreshEvents:["model.hull.me.change"],datasources:{achievement:":id",badge:function(){return this.loggedIn()?this.api("me/badges/"+this.options.id):null}},actions:{play:function(t,e){var a=!!this.loggedIn();if(a)this.play();else{var n=e.data.provider||this.options.provider;this.sandbox.login(n),this.autoPlay=!0}this.track("start",{userLoggedIn:a})}},beforeRender:function(t){this.authProviders=this.authServices(),this.template=this.getInitialTemplate(),t.authProviders=this.authProviders,this.isInitialized||this.track("init",{initialTemplate:this.template})},afterRender:function(){this.autoPlay&&(this.autoPlay=!1,this.userHasWon()||this.play()),("won"===this.template||"lost"===this.template)&&this.track("finish",{result:this.template}),this.sandbox.emit("hull.sweepstake."+this.options.id+".template.render",this.template)},getInitialTemplate:function(){return this.userHasWon()?"won":this.hasEnded()?"ended":this.hasStarted()?this.userCanPlay()?"intro":"played":"unstarted"},hasStarted:function(){return!0},hasEnded:function(){return!1},userCanPlay:function(){if(!this.data.badge||!this.data.badge.attempts)return!0;var t=(new Date).toISOString().slice(0,10);return!this.data.badge.data.attempts[t]},userHasWon:function(){return this.data.badge&&this.data.badge.data?this.data.badge.data.winner:!1},play:function(){"use strict";this.render("working"),this.api(this.id+"/achieve","post",this.sandbox.util._.bind(function(t){var e="played";this.userCanPlay()&&(e=t.data.winner?"won":"lost"),this.sandbox.util._.delay(this.sandbox.util._.bind(function(){this.render(e)},this),parseInt(this.options.delay,10)||0)},this))}});