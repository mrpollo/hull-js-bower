!function(){var require,requirejs,define,root={},HULL_ENV="api";(function(){var requirejs,require,define;!function(a){function b(a,b){return r.call(a,b)}function c(a,b){var c,d,e,f,g,h,i,j,k,l,m,n=b&&b.split("/"),o=p.map,q=o&&o["*"]||{};if(a&&"."===a.charAt(0))if(b){for(n=n.slice(0,n.length-1),a=a.split("/"),g=a.length-1,p.nodeIdCompat&&t.test(a[g])&&(a[g]=a[g].replace(t,"")),a=n.concat(a),k=0;k<a.length;k+=1)if(m=a[k],"."===m)a.splice(k,1),k-=1;else if(".."===m){if(1===k&&(".."===a[2]||".."===a[0]))break;k>0&&(a.splice(k-1,2),k-=2)}a=a.join("/")}else 0===a.indexOf("./")&&(a=a.substring(2));if((n||q)&&o){for(c=a.split("/"),k=c.length;k>0;k-=1){if(d=c.slice(0,k).join("/"),n)for(l=n.length;l>0;l-=1)if(e=o[n.slice(0,l).join("/")],e&&(e=e[d])){f=e,h=k;break}if(f)break;!i&&q&&q[d]&&(i=q[d],j=k)}!f&&i&&(f=i,h=j),f&&(c.splice(0,h,f),a=c.join("/"))}return a}function d(b,c){return function(){return k.apply(a,s.call(arguments,0).concat([b,c]))}}function e(a){return function(b){return c(b,a)}}function f(a){return function(b){n[a]=b}}function g(c){if(b(o,c)){var d=o[c];delete o[c],q[c]=!0,j.apply(a,d)}if(!b(n,c)&&!b(q,c))throw new Error("No "+c);return n[c]}function h(a){var b,c=a?a.indexOf("!"):-1;return c>-1&&(b=a.substring(0,c),a=a.substring(c+1,a.length)),[b,a]}function i(a){return function(){return p&&p.config&&p.config[a]||{}}}var j,k,l,m,n={},o={},p={},q={},r=Object.prototype.hasOwnProperty,s=[].slice,t=/\.js$/;l=function(a,b){var d,f=h(a),i=f[0];return a=f[1],i&&(i=c(i,b),d=g(i)),i?a=d&&d.normalize?d.normalize(a,e(b)):c(a,b):(a=c(a,b),f=h(a),i=f[0],a=f[1],i&&(d=g(i))),{f:i?i+"!"+a:a,n:a,pr:i,p:d}},m={require:function(a){return d(a)},exports:function(a){var b=n[a];return"undefined"!=typeof b?b:n[a]={}},module:function(a){return{id:a,uri:"",exports:n[a],config:i(a)}}},j=function(c,e,h,i){var j,k,p,r,s,t,u=[],v=typeof h;if(i=i||c,"undefined"===v||"function"===v){for(e=!e.length&&h.length?["require","exports","module"]:e,s=0;s<e.length;s+=1)if(r=l(e[s],i),k=r.f,"require"===k)u[s]=m.require(c);else if("exports"===k)u[s]=m.exports(c),t=!0;else if("module"===k)j=u[s]=m.module(c);else if(b(n,k)||b(o,k)||b(q,k))u[s]=g(k);else{if(!r.p)throw new Error(c+" missing "+k);r.p.load(r.n,d(i,!0),f(k),{}),u[s]=n[k]}p=h?h.apply(n[c],u):void 0,c&&(j&&j.exports!==a&&j.exports!==n[c]?n[c]=j.exports:p===a&&t||(n[c]=p))}else c&&(n[c]=h)},requirejs=require=k=function(b,c,d,e,f){if("string"==typeof b)return m[b]?m[b](c):g(l(b,c).f);if(!b.splice){if(p=b,p.deps&&k(p.deps,p.callback),!c)return;c.splice?(b=c,c=d,d=null):b=a}return c=c||function(){},"function"==typeof d&&(d=e,e=f),e?j(a,b,c,d):setTimeout(function(){j(a,b,c,d)},4),k},k.config=function(a){return k(a)},requirejs._defined=n,define=function(a,c,d){c.splice||(d=c,c=[]),b(n,a)||b(o,a)||(o[a]=[a,c,d])},define.amd={jQuery:!0}}(),define("requireLib",function(){}),"object"!=typeof JSON&&(JSON={}),function(){function f(a){return 10>a?"0"+a:a}function quote(a){return escapable.lastIndex=0,escapable.test(a)?'"'+a.replace(escapable,function(a){var b=meta[a];return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function str(a,b){var c,d,e,f,g,h=gap,i=b[a];switch(i&&"object"==typeof i&&"function"==typeof i.toJSON&&(i=i.toJSON(a)),"function"==typeof rep&&(i=rep.call(b,a,i)),typeof i){case"string":return quote(i);case"number":return isFinite(i)?String(i):"null";case"boolean":case"null":return String(i);case"object":if(!i)return"null";if(gap+=indent,g=[],"[object Array]"===Object.prototype.toString.apply(i)){for(f=i.length,c=0;f>c;c+=1)g[c]=str(c,i)||"null";return e=0===g.length?"[]":gap?"[\n"+gap+g.join(",\n"+gap)+"\n"+h+"]":"["+g.join(",")+"]",gap=h,e}if(rep&&"object"==typeof rep)for(f=rep.length,c=0;f>c;c+=1)"string"==typeof rep[c]&&(d=rep[c],e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));else for(d in i)Object.prototype.hasOwnProperty.call(i,d)&&(e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));return e=0===g.length?"{}":gap?"{\n"+gap+g.join(",\n"+gap)+"\n"+h+"}":"{"+g.join(",")+"}",gap=h,e}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var cx,escapable,gap,indent,meta,rep;"function"!=typeof JSON.stringify&&(escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(a,b,c){var d;if(gap="",indent="","number"==typeof c)for(d=0;c>d;d+=1)indent+=" ";else"string"==typeof c&&(indent=c);if(rep=b,b&&"function"!=typeof b&&("object"!=typeof b||"number"!=typeof b.length))throw new Error("JSON.stringify");return str("",{"":a})}),"function"!=typeof JSON.parse&&(cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,JSON.parse=function(text,reviver){function walk(a,b){var c,d,e=a[b];if(e&&"object"==typeof e)for(c in e)Object.prototype.hasOwnProperty.call(e,c)&&(d=walk(e,c),void 0!==d?e[c]=d:delete e[c]);return reviver.call(a,b,e)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),define("json2",function(){}),function(){var a=this,b=a._,c={},d=Array.prototype,e=Object.prototype,f=Function.prototype,g=d.push,h=d.slice,i=d.concat,j=e.toString,k=e.hasOwnProperty,l=d.forEach,m=d.map,n=d.reduce,o=d.reduceRight,p=d.filter,q=d.every,r=d.some,s=d.indexOf,t=d.lastIndexOf,u=Array.isArray,v=Object.keys,w=f.bind,x=function(a){return a instanceof x?a:this instanceof x?void(this._wrapped=a):new x(a)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=x),exports._=x):a._=x,x.VERSION="1.5.2";var y=x.each=x.forEach=function(a,b,d){if(null!=a)if(l&&a.forEach===l)a.forEach(b,d);else if(a.length===+a.length){for(var e=0,f=a.length;f>e;e++)if(b.call(d,a[e],e,a)===c)return}else for(var g=x.keys(a),e=0,f=g.length;f>e;e++)if(b.call(d,a[g[e]],g[e],a)===c)return};x.map=x.collect=function(a,b,c){var d=[];return null==a?d:m&&a.map===m?a.map(b,c):(y(a,function(a,e,f){d.push(b.call(c,a,e,f))}),d)};var z="Reduce of empty array with no initial value";x.reduce=x.foldl=x.inject=function(a,b,c,d){var e=arguments.length>2;if(null==a&&(a=[]),n&&a.reduce===n)return d&&(b=x.bind(b,d)),e?a.reduce(b,c):a.reduce(b);if(y(a,function(a,f,g){e?c=b.call(d,c,a,f,g):(c=a,e=!0)}),!e)throw new TypeError(z);return c},x.reduceRight=x.foldr=function(a,b,c,d){var e=arguments.length>2;if(null==a&&(a=[]),o&&a.reduceRight===o)return d&&(b=x.bind(b,d)),e?a.reduceRight(b,c):a.reduceRight(b);var f=a.length;if(f!==+f){var g=x.keys(a);f=g.length}if(y(a,function(h,i,j){i=g?g[--f]:--f,e?c=b.call(d,c,a[i],i,j):(c=a[i],e=!0)}),!e)throw new TypeError(z);return c},x.find=x.detect=function(a,b,c){var d;return A(a,function(a,e,f){return b.call(c,a,e,f)?(d=a,!0):void 0}),d},x.filter=x.select=function(a,b,c){var d=[];return null==a?d:p&&a.filter===p?a.filter(b,c):(y(a,function(a,e,f){b.call(c,a,e,f)&&d.push(a)}),d)},x.reject=function(a,b,c){return x.filter(a,function(a,d,e){return!b.call(c,a,d,e)},c)},x.every=x.all=function(a,b,d){b||(b=x.identity);var e=!0;return null==a?e:q&&a.every===q?a.every(b,d):(y(a,function(a,f,g){return(e=e&&b.call(d,a,f,g))?void 0:c}),!!e)};var A=x.some=x.any=function(a,b,d){b||(b=x.identity);var e=!1;return null==a?e:r&&a.some===r?a.some(b,d):(y(a,function(a,f,g){return e||(e=b.call(d,a,f,g))?c:void 0}),!!e)};x.contains=x.include=function(a,b){return null==a?!1:s&&a.indexOf===s?-1!=a.indexOf(b):A(a,function(a){return a===b})},x.invoke=function(a,b){var c=h.call(arguments,2),d=x.isFunction(b);return x.map(a,function(a){return(d?b:a[b]).apply(a,c)})},x.pluck=function(a,b){return x.map(a,function(a){return a[b]})},x.where=function(a,b,c){return x.isEmpty(b)?c?void 0:[]:x[c?"find":"filter"](a,function(a){for(var c in b)if(b[c]!==a[c])return!1;return!0})},x.findWhere=function(a,b){return x.where(a,b,!0)},x.max=function(a,b,c){if(!b&&x.isArray(a)&&a[0]===+a[0]&&a.length<65535)return Math.max.apply(Math,a);if(!b&&x.isEmpty(a))return-1/0;var d={computed:-1/0,value:-1/0};return y(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g>d.computed&&(d={value:a,computed:g})}),d.value},x.min=function(a,b,c){if(!b&&x.isArray(a)&&a[0]===+a[0]&&a.length<65535)return Math.min.apply(Math,a);if(!b&&x.isEmpty(a))return 1/0;var d={computed:1/0,value:1/0};return y(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g<d.computed&&(d={value:a,computed:g})}),d.value},x.shuffle=function(a){var b,c=0,d=[];return y(a,function(a){b=x.random(c++),d[c-1]=d[b],d[b]=a}),d},x.sample=function(a,b,c){return arguments.length<2||c?a[x.random(a.length-1)]:x.shuffle(a).slice(0,Math.max(0,b))};var B=function(a){return x.isFunction(a)?a:function(b){return b[a]}};x.sortBy=function(a,b,c){var d=B(b);return x.pluck(x.map(a,function(a,b,e){return{value:a,index:b,criteria:d.call(c,a,b,e)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;if(c!==d){if(c>d||void 0===c)return 1;if(d>c||void 0===d)return-1}return a.index-b.index}),"value")};var C=function(a){return function(b,c,d){var e={},f=null==c?x.identity:B(c);return y(b,function(c,g){var h=f.call(d,c,g,b);a(e,h,c)}),e}};x.groupBy=C(function(a,b,c){(x.has(a,b)?a[b]:a[b]=[]).push(c)}),x.indexBy=C(function(a,b,c){a[b]=c}),x.countBy=C(function(a,b){x.has(a,b)?a[b]++:a[b]=1}),x.sortedIndex=function(a,b,c,d){c=null==c?x.identity:B(c);for(var e=c.call(d,b),f=0,g=a.length;g>f;){var h=f+g>>>1;c.call(d,a[h])<e?f=h+1:g=h}return f},x.toArray=function(a){return a?x.isArray(a)?h.call(a):a.length===+a.length?x.map(a,x.identity):x.values(a):[]},x.size=function(a){return null==a?0:a.length===+a.length?a.length:x.keys(a).length},x.first=x.head=x.take=function(a,b,c){return null==a?void 0:null==b||c?a[0]:h.call(a,0,b)},x.initial=function(a,b,c){return h.call(a,0,a.length-(null==b||c?1:b))},x.last=function(a,b,c){return null==a?void 0:null==b||c?a[a.length-1]:h.call(a,Math.max(a.length-b,0))},x.rest=x.tail=x.drop=function(a,b,c){return h.call(a,null==b||c?1:b)},x.compact=function(a){return x.filter(a,x.identity)};var D=function(a,b,c){return b&&x.every(a,x.isArray)?i.apply(c,a):(y(a,function(a){x.isArray(a)||x.isArguments(a)?b?g.apply(c,a):D(a,b,c):c.push(a)}),c)};x.flatten=function(a,b){return D(a,b,[])},x.without=function(a){return x.difference(a,h.call(arguments,1))},x.uniq=x.unique=function(a,b,c,d){x.isFunction(b)&&(d=c,c=b,b=!1);var e=c?x.map(a,c,d):a,f=[],g=[];return y(e,function(c,d){(b?d&&g[g.length-1]===c:x.contains(g,c))||(g.push(c),f.push(a[d]))}),f},x.union=function(){return x.uniq(x.flatten(arguments,!0))},x.intersection=function(a){var b=h.call(arguments,1);return x.filter(x.uniq(a),function(a){return x.every(b,function(b){return x.indexOf(b,a)>=0})})},x.difference=function(a){var b=i.apply(d,h.call(arguments,1));return x.filter(a,function(a){return!x.contains(b,a)})},x.zip=function(){for(var a=x.max(x.pluck(arguments,"length").concat(0)),b=new Array(a),c=0;a>c;c++)b[c]=x.pluck(arguments,""+c);return b},x.object=function(a,b){if(null==a)return{};for(var c={},d=0,e=a.length;e>d;d++)b?c[a[d]]=b[d]:c[a[d][0]]=a[d][1];return c},x.indexOf=function(a,b,c){if(null==a)return-1;var d=0,e=a.length;if(c){if("number"!=typeof c)return d=x.sortedIndex(a,b),a[d]===b?d:-1;d=0>c?Math.max(0,e+c):c}if(s&&a.indexOf===s)return a.indexOf(b,c);for(;e>d;d++)if(a[d]===b)return d;return-1},x.lastIndexOf=function(a,b,c){if(null==a)return-1;var d=null!=c;if(t&&a.lastIndexOf===t)return d?a.lastIndexOf(b,c):a.lastIndexOf(b);for(var e=d?c:a.length;e--;)if(a[e]===b)return e;return-1},x.range=function(a,b,c){arguments.length<=1&&(b=a||0,a=0),c=arguments[2]||1;for(var d=Math.max(Math.ceil((b-a)/c),0),e=0,f=new Array(d);d>e;)f[e++]=a,a+=c;return f};var E=function(){};x.bind=function(a,b){var c,d;if(w&&a.bind===w)return w.apply(a,h.call(arguments,1));if(!x.isFunction(a))throw new TypeError;return c=h.call(arguments,2),d=function(){if(!(this instanceof d))return a.apply(b,c.concat(h.call(arguments)));E.prototype=a.prototype;var e=new E;E.prototype=null;var f=a.apply(e,c.concat(h.call(arguments)));return Object(f)===f?f:e}},x.partial=function(a){var b=h.call(arguments,1);return function(){return a.apply(this,b.concat(h.call(arguments)))}},x.bindAll=function(a){var b=h.call(arguments,1);if(0===b.length)throw new Error("bindAll must be passed function names");return y(b,function(b){a[b]=x.bind(a[b],a)}),a},x.memoize=function(a,b){var c={};return b||(b=x.identity),function(){var d=b.apply(this,arguments);return x.has(c,d)?c[d]:c[d]=a.apply(this,arguments)}},x.delay=function(a,b){var c=h.call(arguments,2);return setTimeout(function(){return a.apply(null,c)},b)},x.defer=function(a){return x.delay.apply(x,[a,1].concat(h.call(arguments,1)))},x.throttle=function(a,b,c){var d,e,f,g=null,h=0;c||(c={});var i=function(){h=c.leading===!1?0:new Date,g=null,f=a.apply(d,e)};return function(){var j=new Date;h||c.leading!==!1||(h=j);var k=b-(j-h);return d=this,e=arguments,0>=k?(clearTimeout(g),g=null,h=j,f=a.apply(d,e)):g||c.trailing===!1||(g=setTimeout(i,k)),f}},x.debounce=function(a,b,c){var d,e,f,g,h;return function(){f=this,e=arguments,g=new Date;var i=function(){var j=new Date-g;b>j?d=setTimeout(i,b-j):(d=null,c||(h=a.apply(f,e)))},j=c&&!d;return d||(d=setTimeout(i,b)),j&&(h=a.apply(f,e)),h}},x.once=function(a){var b,c=!1;return function(){return c?b:(c=!0,b=a.apply(this,arguments),a=null,b)}},x.wrap=function(a,b){return function(){var c=[a];return g.apply(c,arguments),b.apply(this,c)}},x.compose=function(){var a=arguments;return function(){for(var b=arguments,c=a.length-1;c>=0;c--)b=[a[c].apply(this,b)];return b[0]}},x.after=function(a,b){return function(){return--a<1?b.apply(this,arguments):void 0}},x.keys=v||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[];for(var c in a)x.has(a,c)&&b.push(c);return b},x.values=function(a){for(var b=x.keys(a),c=b.length,d=new Array(c),e=0;c>e;e++)d[e]=a[b[e]];return d},x.pairs=function(a){for(var b=x.keys(a),c=b.length,d=new Array(c),e=0;c>e;e++)d[e]=[b[e],a[b[e]]];return d},x.invert=function(a){for(var b={},c=x.keys(a),d=0,e=c.length;e>d;d++)b[a[c[d]]]=c[d];return b},x.functions=x.methods=function(a){var b=[];for(var c in a)x.isFunction(a[c])&&b.push(c);return b.sort()},x.extend=function(a){return y(h.call(arguments,1),function(b){if(b)for(var c in b)a[c]=b[c]}),a},x.pick=function(a){var b={},c=i.apply(d,h.call(arguments,1));return y(c,function(c){c in a&&(b[c]=a[c])}),b},x.omit=function(a){var b={},c=i.apply(d,h.call(arguments,1));for(var e in a)x.contains(c,e)||(b[e]=a[e]);return b},x.defaults=function(a){return y(h.call(arguments,1),function(b){if(b)for(var c in b)void 0===a[c]&&(a[c]=b[c])}),a},x.clone=function(a){return x.isObject(a)?x.isArray(a)?a.slice():x.extend({},a):a},x.tap=function(a,b){return b(a),a};var F=function(a,b,c,d){if(a===b)return 0!==a||1/a==1/b;if(null==a||null==b)return a===b;a instanceof x&&(a=a._wrapped),b instanceof x&&(b=b._wrapped);var e=j.call(a);if(e!=j.call(b))return!1;switch(e){case"[object String]":return a==String(b);case"[object Number]":return a!=+a?b!=+b:0==a?1/a==1/b:a==+b;case"[object Date]":case"[object Boolean]":return+a==+b;case"[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if("object"!=typeof a||"object"!=typeof b)return!1;for(var f=c.length;f--;)if(c[f]==a)return d[f]==b;var g=a.constructor,h=b.constructor;if(g!==h&&!(x.isFunction(g)&&g instanceof g&&x.isFunction(h)&&h instanceof h))return!1;c.push(a),d.push(b);var i=0,k=!0;if("[object Array]"==e){if(i=a.length,k=i==b.length)for(;i--&&(k=F(a[i],b[i],c,d)););}else{for(var l in a)if(x.has(a,l)&&(i++,!(k=x.has(b,l)&&F(a[l],b[l],c,d))))break;if(k){for(l in b)if(x.has(b,l)&&!i--)break;k=!i}}return c.pop(),d.pop(),k};x.isEqual=function(a,b){return F(a,b,[],[])},x.isEmpty=function(a){if(null==a)return!0;if(x.isArray(a)||x.isString(a))return 0===a.length;for(var b in a)if(x.has(a,b))return!1;return!0},x.isElement=function(a){return!(!a||1!==a.nodeType)},x.isArray=u||function(a){return"[object Array]"==j.call(a)},x.isObject=function(a){return a===Object(a)},y(["Arguments","Function","String","Number","Date","RegExp"],function(a){x["is"+a]=function(b){return j.call(b)=="[object "+a+"]"}}),x.isArguments(arguments)||(x.isArguments=function(a){return!(!a||!x.has(a,"callee"))}),"function"!=typeof/./&&(x.isFunction=function(a){return"function"==typeof a}),x.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))},x.isNaN=function(a){return x.isNumber(a)&&a!=+a},x.isBoolean=function(a){return a===!0||a===!1||"[object Boolean]"==j.call(a)},x.isNull=function(a){return null===a},x.isUndefined=function(a){return void 0===a},x.has=function(a,b){return k.call(a,b)},x.noConflict=function(){return a._=b,this},x.identity=function(a){return a},x.times=function(a,b,c){for(var d=Array(Math.max(0,a)),e=0;a>e;e++)d[e]=b.call(c,e);return d},x.random=function(a,b){return null==b&&(b=a,a=0),a+Math.floor(Math.random()*(b-a+1))};var G={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};G.unescape=x.invert(G.escape);var H={escape:new RegExp("["+x.keys(G.escape).join("")+"]","g"),unescape:new RegExp("("+x.keys(G.unescape).join("|")+")","g")};x.each(["escape","unescape"],function(a){x[a]=function(b){return null==b?"":(""+b).replace(H[a],function(b){return G[a][b]})}}),x.result=function(a,b){if(null==a)return void 0;var c=a[b];return x.isFunction(c)?c.call(a):c},x.mixin=function(a){y(x.functions(a),function(b){var c=x[b]=a[b];x.prototype[b]=function(){var a=[this._wrapped];return g.apply(a,arguments),M.call(this,c.apply(x,a))}})};var I=0;x.uniqueId=function(a){var b=++I+"";return a?a+b:b},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var J=/(.)^/,K={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},L=/\\|'|\r|\n|\t|\u2028|\u2029/g;x.template=function(a,b,c){var d;c=x.defaults({},c,x.templateSettings);var e=new RegExp([(c.escape||J).source,(c.interpolate||J).source,(c.evaluate||J).source].join("|")+"|$","g"),f=0,g="__p+='";a.replace(e,function(b,c,d,e,h){return g+=a.slice(f,h).replace(L,function(a){return"\\"+K[a]}),c&&(g+="'+\n((__t=("+c+"))==null?'':_.escape(__t))+\n'"),d&&(g+="'+\n((__t=("+d+"))==null?'':__t)+\n'"),e&&(g+="';\n"+e+"\n__p+='"),f=h+b.length,b}),g+="';\n",c.variable||(g="with(obj||{}){\n"+g+"}\n"),g="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+g+"return __p;\n";try{d=new Function(c.variable||"obj","_",g)}catch(h){throw h.source=g,h}if(b)return d(b,x);var i=function(a){return d.call(this,a,x)};return i.source="function("+(c.variable||"obj")+"){\n"+g+"}",i},x.chain=function(a){return x(a).chain()};var M=function(a){return this._chain?x(a).chain():a};x.mixin(x),y(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=d[a];x.prototype[a]=function(){var c=this._wrapped;return b.apply(c,arguments),"shift"!=a&&"splice"!=a||0!==c.length||delete c[0],M.call(this,c)}}),y(["concat","join","slice"],function(a){var b=d[a];x.prototype[a]=function(){return M.call(this,b.apply(this._wrapped,arguments))}}),x.extend(x.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}.call(this),define("underscore",function(a){return function(){var b;return b||a._}}(this)),function(a){var b=function(a,c,d){return 1===arguments.length?b.get(a):b.set(a,c,d)};b._document=document,b._navigator=navigator,b.defaults={path:"/"},b.get=function(a){return b._cachedDocumentCookie!==b._document.cookie&&b._renewCache(),b._cache[a]},b.set=function(c,d,e){return e=b._getExtendedOptions(e),e.expires=b._getExpiresDate(d===a?-1:e.expires),b._document.cookie=b._generateCookieString(c,d,e),b},b.expire=function(c,d){return b.set(c,a,d)},b._getExtendedOptions=function(c){return{path:c&&c.path||b.defaults.path,domain:c&&c.domain||b.defaults.domain,expires:c&&c.expires||b.defaults.expires,secure:c&&c.secure!==a?c.secure:b.defaults.secure}},b._isValidDate=function(a){return"[object Date]"===Object.prototype.toString.call(a)&&!isNaN(a.getTime())},b._getExpiresDate=function(a,c){switch(c=c||new Date,typeof a){case"number":a=new Date(c.getTime()+1e3*a);break;case"string":a=new Date(a)}if(a&&!b._isValidDate(a))throw new Error("`expires` parameter cannot be converted to a valid Date instance");return a},b._generateCookieString=function(a,b,c){a=encodeURIComponent(a),b=(b+"").replace(/[^!#$&-+\--:<-\[\]-~]/g,encodeURIComponent),c=c||{};var d=a+"="+b;return d+=c.path?";path="+c.path:"",d+=c.domain?";domain="+c.domain:"",d+=c.expires?";expires="+c.expires.toGMTString():"",d+=c.secure?";secure":""},b._getCookieObjectFromString=function(c){for(var d={},e=c?c.split("; "):[],f=0;f<e.length;f++){var g=b._getKeyValuePairFromCookieString(e[f]);d[g.key]===a&&(d[g.key]=g.value)}return d},b._getKeyValuePairFromCookieString=function(a){var b=a.indexOf("=");return b=0>b?a.length:b,{key:decodeURIComponent(a.substr(0,b)),value:decodeURIComponent(a.substr(b+1))}},b._renewCache=function(){b._cache=b._getCookieObjectFromString(b._document.cookie),b._cachedDocumentCookie=b._document.cookie},b._areEnabled=function(){return b._navigator.cookieEnabled||"1"===b.set("cookies.js",1).get("cookies.js")},b.enabled=b._areEnabled(),"function"==typeof define&&define.amd?define("cookie",[],function(){return b}):"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=b),exports.Cookies=b):window.Cookies=b}(),function(){var a="undefined"!=typeof window?window:exports,b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c=function(){try{document.createElement("$")}catch(a){return a}}();a.btoa||(a.btoa=function(a){for(var d,e,f=0,g=b,h="";a.charAt(0|f)||(g="=",f%1);h+=g.charAt(63&d>>8-f%1*8)){if(e=a.charCodeAt(f+=.75),e>255)throw c;d=d<<8|e}return h}),a.atob||(a.atob=function(a){if(a=a.replace(/=+$/,""),a.length%4==1)throw c;for(var d,e,f=0,g=0,h="";e=a.charAt(g++);~e&&(d=f%4?64*d+e:e,f++%4)?h+=String.fromCharCode(255&d>>(-2*f&6)):0)e=b.indexOf(e);return h})}(),define("base64",function(){}),!function(a,b){"undefined"!=typeof module?module.exports=b():"function"==typeof define&&"object"==typeof define.amd?define("domready",b):this[a]=b()}("domready",function(a){function b(a){for(n=1;a=d.shift();)a()}var c,d=[],e=!1,f=document,g=f.documentElement,h=g.doScroll,i="DOMContentLoaded",j="addEventListener",k="onreadystatechange",l="readyState",m=h?/^loaded|^c/:/^loaded|c/,n=m.test(f[l]);return f[j]&&f[j](i,c=function(){f.removeEventListener(i,c,e),b()},e),h&&f.attachEvent(k,c=function(){/^c/.test(f[l])&&(f.detachEvent(k,c),b())}),a=h?function(b){self!=top?n?b():d.push(b):function(){try{g.doScroll("left")}catch(c){return setTimeout(function(){a(b)},50)}b()}()}:function(a){n?a():d.push(a)}}),function(a){if("function"==typeof bootstrap)bootstrap("promise",a);else if("object"==typeof exports)module.exports=a();else if("function"==typeof define&&define.amd)define("promises",a);else if("undefined"!=typeof ses){if(!ses.ok())return;ses.makeQ=a}else Q=a()}(function(){function a(a){return function(){return X.apply(a,arguments)}}function b(a){return a===Object(a)}function c(a){return"[object StopIteration]"===db(a)||a instanceof T}function d(a,b){if(Q&&b.stack&&"object"==typeof a&&null!==a&&a.stack&&-1===a.stack.indexOf(fb)){for(var c=[],d=b;d;d=d.source)d.stack&&c.unshift(d.stack);c.unshift(a.stack);var f=c.join("\n"+fb+"\n");a.stack=e(f)}}function e(a){for(var b=a.split("\n"),c=[],d=0;d<b.length;++d){var e=b[d];h(e)||f(e)||!e||c.push(e)}return c.join("\n")}function f(a){return-1!==a.indexOf("(module.js:")||-1!==a.indexOf("(node.js:")}function g(a){var b=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(a);if(b)return[b[1],Number(b[2])];var c=/at ([^ ]+):(\d+):(?:\d+)$/.exec(a);if(c)return[c[1],Number(c[2])];var d=/.*@(.+):(\d+)$/.exec(a);return d?[d[1],Number(d[2])]:void 0}function h(a){var b=g(a);if(!b)return!1;var c=b[0],d=b[1];return c===S&&d>=U&&kb>=d}function i(){if(Q)try{throw new Error}catch(a){var b=a.stack.split("\n"),c=b[0].indexOf("@")>0?b[1]:b[2],d=g(c);if(!d)return;return S=d[0],d[1]}}function j(a,b,c){return function(){return"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(b+" is deprecated, use "+c+" instead.",new Error("").stack),a.apply(a,arguments)}}function k(a){return r(a)?a:s(a)?D(a):C(a)}function l(){function a(a){b=a,f.source=a,Z(c,function(b,c){W(function(){a.promiseDispatch.apply(a,c)})},void 0),c=void 0,d=void 0}var b,c=[],d=[],e=ab(l.prototype),f=ab(o.prototype);if(f.promiseDispatch=function(a,e,f){var g=Y(arguments);c?(c.push(g),"when"===e&&f[1]&&d.push(f[1])):W(function(){b.promiseDispatch.apply(b,g)})},f.valueOf=j(function(){if(c)return f;var a=q(b);return r(a)&&(b=a),a},"valueOf","inspect"),f.inspect=function(){return b?b.inspect():{state:"pending"}},k.longStackSupport&&Q)try{throw new Error}catch(g){f.stack=g.stack.substring(g.stack.indexOf("\n")+1)}return e.promise=f,e.resolve=function(c){b||a(k(c))},e.fulfill=function(c){b||a(C(c))},e.reject=function(c){b||a(B(c))},e.notify=function(a){b||Z(d,function(b,c){W(function(){c(a)})},void 0)},e}function m(a){if("function"!=typeof a)throw new TypeError("resolver must be a function.");var b=l();try{a(b.resolve,b.reject,b.notify)}catch(c){b.reject(c)}return b.promise}function n(a){return m(function(b,c){for(var d=0,e=a.length;e>d;d++)k(a[d]).then(b,c)})}function o(a,b,c){void 0===b&&(b=function(a){return B(new Error("Promise does not support operation: "+a))}),void 0===c&&(c=function(){return{state:"unknown"}});var d=ab(o.prototype);if(d.promiseDispatch=function(c,e,f){var g;try{g=a[e]?a[e].apply(d,f):b.call(d,e,f)}catch(h){g=B(h)}c&&c(g)},d.inspect=c,c){var e=c();"rejected"===e.state&&(d.exception=e.reason),d.valueOf=j(function(){var a=c();return"pending"===a.state||"rejected"===a.state?d:a.value})}return d}function p(a,b,c,d){return k(a).then(b,c,d)}function q(a){if(r(a)){var b=a.inspect();if("fulfilled"===b.state)return b.value}return a}function r(a){return b(a)&&"function"==typeof a.promiseDispatch&&"function"==typeof a.inspect}function s(a){return b(a)&&"function"==typeof a.then}function t(a){return r(a)&&"pending"===a.inspect().state}function u(a){return!r(a)||"fulfilled"===a.inspect().state}function v(a){return r(a)&&"rejected"===a.inspect().state}function w(){ib||"undefined"==typeof window||window.Touch||!window.console||console.warn("[Q] Unhandled rejection reasons (should be empty):",gb),ib=!0}function x(){for(var a=0;a<gb.length;a++){var b=gb[a];console.warn("Unhandled rejection reason:",b)}}function y(){gb.length=0,hb.length=0,ib=!1,jb||(jb=!0,"undefined"!=typeof process&&process.on&&process.on("exit",x))}function z(a,b){jb&&(hb.push(a),gb.push(b&&"undefined"!=typeof b.stack?b.stack:"(no stack) "+b),w())}function A(a){if(jb){var b=$(hb,a);-1!==b&&(hb.splice(b,1),gb.splice(b,1))}}function B(a){var b=o({when:function(b){return b&&A(this),b?b(a):this}},function(){return this},function(){return{state:"rejected",reason:a}});return z(b,a),b}function C(a){return o({when:function(){return a},get:function(b){return a[b]},set:function(b,c){a[b]=c},"delete":function(b){delete a[b]},post:function(b,c){return null===b||void 0===b?a.apply(void 0,c):a[b].apply(a,c)},apply:function(b,c){return a.apply(b,c)},keys:function(){return cb(a)}},void 0,function(){return{state:"fulfilled",value:a}})}function D(a){var b=l();return W(function(){try{a.then(b.resolve,b.reject,b.notify)}catch(c){b.reject(c)}}),b.promise}function E(a){return o({isDef:function(){}},function(b,c){return K(a,b,c)},function(){return k(a).inspect()})}function F(a,b,c){return k(a).spread(b,c)}function G(a){return function(){function b(a,b){var g;if(eb){try{g=d[a](b)}catch(h){return B(h)}return g.done?g.value:p(g.value,e,f)}try{g=d[a](b)}catch(h){return c(h)?h.value:B(h)}return p(g,e,f)}var d=a.apply(this,arguments),e=b.bind(b,"next"),f=b.bind(b,"throw");return e()}}function H(a){k.done(k.async(a)())}function I(a){throw new T(a)}function J(a){return function(){return F([this,L(arguments)],function(b,c){return a.apply(b,c)})}}function K(a,b,c){return k(a).dispatch(b,c)}function L(a){return p(a,function(a){var b=0,c=l();return Z(a,function(d,e,f){var g;r(e)&&"fulfilled"===(g=e.inspect()).state?a[f]=g.value:(++b,p(e,function(d){a[f]=d,0===--b&&c.resolve(a)},c.reject,function(a){c.notify({index:f,value:a})}))},void 0),0===b&&c.resolve(a),c.promise})}function M(a){return p(a,function(a){return a=_(a,k),p(L(_(a,function(a){return p(a,V,V)})),function(){return a})})}function N(a){return k(a).allSettled()}function O(a,b){return k(a).then(void 0,void 0,b)}function P(a,b){return k(a).nodeify(b)}var Q=!1;try{throw new Error}catch(R){Q=!!R.stack}var S,T,U=i(),V=function(){},W=function(){function a(){for(;b.next;){b=b.next;var c=b.task;b.task=void 0;var e=b.domain;e&&(b.domain=void 0,e.enter());try{c()}catch(g){if(f)throw e&&e.exit(),setTimeout(a,0),e&&e.enter(),g;setTimeout(function(){throw g},0)}e&&e.exit()}d=!1}var b={task:void 0,next:null},c=b,d=!1,e=void 0,f=!1;if(W=function(a){c=c.next={task:a,domain:f&&process.domain,next:null},d||(d=!0,e())},"undefined"!=typeof process&&process.nextTick)f=!0,e=function(){process.nextTick(a)};else if("function"==typeof setImmediate)e="undefined"!=typeof window?setImmediate.bind(window,a):function(){setImmediate(a)};else if("undefined"!=typeof MessageChannel){var g=new MessageChannel;g.port1.onmessage=function(){e=h,g.port1.onmessage=a,a()};var h=function(){g.port2.postMessage(0)};e=function(){setTimeout(a,0),h()}}else e=function(){setTimeout(a,0)};return W}(),X=Function.call,Y=a(Array.prototype.slice),Z=a(Array.prototype.reduce||function(a,b){var c=0,d=this.length;if(1===arguments.length)for(;;){if(c in this){b=this[c++];break}if(++c>=d)throw new TypeError}for(;d>c;c++)c in this&&(b=a(b,this[c],c));return b}),$=a(Array.prototype.indexOf||function(a){for(var b=0;b<this.length;b++)if(this[b]===a)return b;return-1}),_=a(Array.prototype.map||function(a,b){var c=this,d=[];return Z(c,function(e,f,g){d.push(a.call(b,f,g,c))},void 0),d}),ab=Object.create||function(a){function b(){}return b.prototype=a,new b},bb=a(Object.prototype.hasOwnProperty),cb=Object.keys||function(a){var b=[];for(var c in a)bb(a,c)&&b.push(c);return b},db=a(Object.prototype.toString);T="undefined"!=typeof ReturnValue?ReturnValue:function(a){this.value=a};var eb;try{new Function("(function* (){ yield 1; })"),eb=!0}catch(R){eb=!1}var fb="From previous event:";k.resolve=k,k.nextTick=W,k.longStackSupport=!1,k.defer=l,l.prototype.makeNodeResolver=function(){var a=this;return function(b,c){b?a.reject(b):a.resolve(arguments.length>2?Y(arguments,1):c)}},k.promise=m,k.passByCopy=function(a){return a},o.prototype.passByCopy=function(){return this},k.join=function(a,b){return k(a).join(b)},o.prototype.join=function(a){return k([this,a]).spread(function(a,b){if(a===b)return a;throw new Error("Can't join: not the same: "+a+" "+b)})},k.race=n,o.prototype.race=function(){return this.then(k.race)},k.makePromise=o,o.prototype.toString=function(){return"[object Promise]"},o.prototype.then=function(a,b,c){function e(b){try{return"function"==typeof a?a(b):b}catch(c){return B(c)}}function f(a){if("function"==typeof b){d(a,h);try{return b(a)}catch(c){return B(c)}}return B(a)}function g(a){return"function"==typeof c?c(a):a}var h=this,i=l(),j=!1;return W(function(){h.promiseDispatch(function(a){j||(j=!0,i.resolve(e(a)))
},"when",[function(a){j||(j=!0,i.resolve(f(a)))}])}),h.promiseDispatch(void 0,"when",[void 0,function(a){var b,c=!1;try{b=g(a)}catch(d){if(c=!0,!k.onerror)throw d;k.onerror(d)}c||i.notify(b)}]),i.promise},k.when=p,o.prototype.thenResolve=function(a){return this.then(function(){return a})},k.thenResolve=function(a,b){return k(a).thenResolve(b)},o.prototype.thenReject=function(a){return this.then(function(){throw a})},k.thenReject=function(a,b){return k(a).thenReject(b)},k.nearer=q,k.isPromise=r,k.isPromiseAlike=s,k.isPending=t,o.prototype.isPending=function(){return"pending"===this.inspect().state},k.isFulfilled=u,o.prototype.isFulfilled=function(){return"fulfilled"===this.inspect().state},k.isRejected=v,o.prototype.isRejected=function(){return"rejected"===this.inspect().state};var gb=[],hb=[],ib=!1,jb=!0;k.resetUnhandledRejections=y,k.getUnhandledReasons=function(){return gb.slice()},k.stopUnhandledRejectionTracking=function(){y(),"undefined"!=typeof process&&process.on&&process.removeListener("exit",x),jb=!1},y(),k.reject=B,k.fulfill=C,k.master=E,k.spread=F,o.prototype.spread=function(a,b){return this.all().then(function(b){return a.apply(void 0,b)},b)},k.async=G,k.spawn=H,k["return"]=I,k.promised=J,k.dispatch=K,o.prototype.dispatch=function(a,b){var c=this,d=l();return W(function(){c.promiseDispatch(d.resolve,a,b)}),d.promise},k.get=function(a,b){return k(a).dispatch("get",[b])},o.prototype.get=function(a){return this.dispatch("get",[a])},k.set=function(a,b,c){return k(a).dispatch("set",[b,c])},o.prototype.set=function(a,b){return this.dispatch("set",[a,b])},k.del=k["delete"]=function(a,b){return k(a).dispatch("delete",[b])},o.prototype.del=o.prototype["delete"]=function(a){return this.dispatch("delete",[a])},k.mapply=k.post=function(a,b,c){return k(a).dispatch("post",[b,c])},o.prototype.mapply=o.prototype.post=function(a,b){return this.dispatch("post",[a,b])},k.send=k.mcall=k.invoke=function(a,b){return k(a).dispatch("post",[b,Y(arguments,2)])},o.prototype.send=o.prototype.mcall=o.prototype.invoke=function(a){return this.dispatch("post",[a,Y(arguments,1)])},k.fapply=function(a,b){return k(a).dispatch("apply",[void 0,b])},o.prototype.fapply=function(a){return this.dispatch("apply",[void 0,a])},k["try"]=k.fcall=function(a){return k(a).dispatch("apply",[void 0,Y(arguments,1)])},o.prototype.fcall=function(){return this.dispatch("apply",[void 0,Y(arguments)])},k.fbind=function(a){var b=k(a),c=Y(arguments,1);return function(){return b.dispatch("apply",[this,c.concat(Y(arguments))])}},o.prototype.fbind=function(){var a=this,b=Y(arguments);return function(){return a.dispatch("apply",[this,b.concat(Y(arguments))])}},k.keys=function(a){return k(a).dispatch("keys",[])},o.prototype.keys=function(){return this.dispatch("keys",[])},k.all=L,o.prototype.all=function(){return L(this)},k.allResolved=j(M,"allResolved","allSettled"),o.prototype.allResolved=function(){return M(this)},k.allSettled=N,o.prototype.allSettled=function(){return this.then(function(a){return L(_(a,function(a){function b(){return a.inspect()}return a=k(a),a.then(b,b)}))})},k.fail=k["catch"]=function(a,b){return k(a).then(void 0,b)},o.prototype.fail=o.prototype["catch"]=function(a){return this.then(void 0,a)},k.progress=O,o.prototype.progress=function(a){return this.then(void 0,void 0,a)},k.fin=k["finally"]=function(a,b){return k(a)["finally"](b)},o.prototype.fin=o.prototype["finally"]=function(a){return a=k(a),this.then(function(b){return a.fcall().then(function(){return b})},function(b){return a.fcall().then(function(){throw b})})},k.done=function(a,b,c,d){return k(a).done(b,c,d)},o.prototype.done=function(a,b,c){var e=function(a){W(function(){if(d(a,f),!k.onerror)throw a;k.onerror(a)})},f=a||b||c?this.then(a,b,c):this;"object"==typeof process&&process&&process.domain&&(e=process.domain.bind(e)),f.then(void 0,e)},k.timeout=function(a,b,c){return k(a).timeout(b,c)},o.prototype.timeout=function(a,b){var c=l(),d=setTimeout(function(){c.reject(new Error(b||"Timed out after "+a+" ms"))},a);return this.then(function(a){clearTimeout(d),c.resolve(a)},function(a){clearTimeout(d),c.reject(a)},c.notify),c.promise},k.delay=function(a,b){return void 0===b&&(b=a,a=void 0),k(a).delay(b)},o.prototype.delay=function(a){return this.then(function(b){var c=l();return setTimeout(function(){c.resolve(b)},a),c.promise})},k.nfapply=function(a,b){return k(a).nfapply(b)},o.prototype.nfapply=function(a){var b=l(),c=Y(a);return c.push(b.makeNodeResolver()),this.fapply(c).fail(b.reject),b.promise},k.nfcall=function(a){var b=Y(arguments,1);return k(a).nfapply(b)},o.prototype.nfcall=function(){var a=Y(arguments),b=l();return a.push(b.makeNodeResolver()),this.fapply(a).fail(b.reject),b.promise},k.nfbind=k.denodeify=function(a){var b=Y(arguments,1);return function(){var c=b.concat(Y(arguments)),d=l();return c.push(d.makeNodeResolver()),k(a).fapply(c).fail(d.reject),d.promise}},o.prototype.nfbind=o.prototype.denodeify=function(){var a=Y(arguments);return a.unshift(this),k.denodeify.apply(void 0,a)},k.nbind=function(a,b){var c=Y(arguments,2);return function(){function d(){return a.apply(b,arguments)}var e=c.concat(Y(arguments)),f=l();return e.push(f.makeNodeResolver()),k(d).fapply(e).fail(f.reject),f.promise}},o.prototype.nbind=function(){var a=Y(arguments,0);return a.unshift(this),k.nbind.apply(void 0,a)},k.nmapply=k.npost=function(a,b,c){return k(a).npost(b,c)},o.prototype.nmapply=o.prototype.npost=function(a,b){var c=Y(b||[]),d=l();return c.push(d.makeNodeResolver()),this.dispatch("post",[a,c]).fail(d.reject),d.promise},k.nsend=k.nmcall=k.ninvoke=function(a,b){var c=Y(arguments,2),d=l();return c.push(d.makeNodeResolver()),k(a).dispatch("post",[b,c]).fail(d.reject),d.promise},o.prototype.nsend=o.prototype.nmcall=o.prototype.ninvoke=function(a){var b=Y(arguments,1),c=l();return b.push(c.makeNodeResolver()),this.dispatch("post",[a,b]).fail(c.reject),c.promise},k.nodeify=P,o.prototype.nodeify=function(a){return a?void this.then(function(b){W(function(){a(null,b)})},function(b){W(function(){a(b)})}):this};var kb=i();return k}),function(){define("lib/utils/promises",["promises"],function(a){return{deferred:a.defer,when:a.when,all:a.all}})}.call(this),!function(){function a(){this._events={},this._conf&&b.call(this,this._conf)}function b(a){a&&(this._conf=a,a.delimiter&&(this.delimiter=a.delimiter),a.maxListeners&&(this._events.maxListeners=a.maxListeners),a.wildcard&&(this.wildcard=a.wildcard),a.newListener&&(this.newListener=a.newListener),this.wildcard&&(this.listenerTree={}))}function c(a){this._events={},this.newListener=!1,b.call(this,a)}function d(a,b,c,e){if(!c)return[];var f,g,h,i,j,k,l,m=[],n=b.length,o=b[e],p=b[e+1];if(e===n&&c._listeners){if("function"==typeof c._listeners)return a&&a.push(c._listeners),[c];for(f=0,g=c._listeners.length;g>f;f++)a&&a.push(c._listeners[f]);return[c]}if("*"===o||"**"===o||c[o]){if("*"===o){for(h in c)"_listeners"!==h&&c.hasOwnProperty(h)&&(m=m.concat(d(a,b,c[h],e+1)));return m}if("**"===o){l=e+1===n||e+2===n&&"*"===p,l&&c._listeners&&(m=m.concat(d(a,b,c,n)));for(h in c)"_listeners"!==h&&c.hasOwnProperty(h)&&("*"===h||"**"===h?(c[h]._listeners&&!l&&(m=m.concat(d(a,b,c[h],n))),m=m.concat(d(a,b,c[h],e))):m=m.concat(h===p?d(a,b,c[h],e+2):d(a,b,c[h],e)));return m}m=m.concat(d(a,b,c[o],e+1))}if(i=c["*"],i&&d(a,b,i,e+1),j=c["**"])if(n>e){j._listeners&&d(a,b,j,n);for(h in j)"_listeners"!==h&&j.hasOwnProperty(h)&&(h===p?d(a,b,j[h],e+2):h===o?d(a,b,j[h],e+1):(k={},k[h]=j[h],d(a,b,{"**":k},e+1)))}else j._listeners?d(a,b,j,n):j["*"]&&j["*"]._listeners&&d(a,b,j["*"],n);return m}function e(a,b){a="string"==typeof a?a.split(this.delimiter):a.slice();for(var c=0,d=a.length;d>c+1;c++)if("**"===a[c]&&"**"===a[c+1])return;for(var e=this.listenerTree,h=a.shift();h;){if(e[h]||(e[h]={}),e=e[h],0===a.length){if(e._listeners){if("function"==typeof e._listeners)e._listeners=[e._listeners,b];else if(f(e._listeners)&&(e._listeners.push(b),!e._listeners.warned)){var i=g;"undefined"!=typeof this._events.maxListeners&&(i=this._events.maxListeners),i>0&&e._listeners.length>i&&(e._listeners.warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",e._listeners.length),console.trace())}}else e._listeners=b;return!0}h=a.shift()}return!0}var f=Array.isArray?Array.isArray:function(a){return"[object Array]"===Object.prototype.toString.call(a)},g=10;c.prototype.delimiter=".",c.prototype.setMaxListeners=function(b){this._events||a.call(this),this._events.maxListeners=b,this._conf||(this._conf={}),this._conf.maxListeners=b},c.prototype.event="",c.prototype.once=function(a,b){return this.many(a,1,b),this},c.prototype.many=function(a,b,c){function d(){0===--b&&e.off(a,d),c.apply(this,arguments)}var e=this;if("function"!=typeof c)throw new Error("many only accepts instances of Function");return d._origin=c,this.on(a,d),e},c.prototype.emit=function(){this._events||a.call(this);var b=arguments[0];if("newListener"===b&&!this.newListener&&!this._events.newListener)return!1;if(this._all){for(var c=arguments.length,e=new Array(c-1),f=1;c>f;f++)e[f-1]=arguments[f];for(f=0,c=this._all.length;c>f;f++)this.event=b,this._all[f].apply(this,e)}if("error"===b&&!(this._all||this._events.error||this.wildcard&&this.listenerTree.error))throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");var g;if(this.wildcard){g=[];var h="string"==typeof b?b.split(this.delimiter):b.slice();d.call(this,g,h,this.listenerTree,0)}else g=this._events[b];if("function"==typeof g){if(this.event=b,1===arguments.length)g.call(this);else if(arguments.length>1)switch(arguments.length){case 2:g.call(this,arguments[1]);break;case 3:g.call(this,arguments[1],arguments[2]);break;default:for(var c=arguments.length,e=new Array(c-1),f=1;c>f;f++)e[f-1]=arguments[f];g.apply(this,e)}return!0}if(g){for(var c=arguments.length,e=new Array(c-1),f=1;c>f;f++)e[f-1]=arguments[f];for(var i=g.slice(),f=0,c=i.length;c>f;f++)this.event=b,i[f].apply(this,e);return i.length>0||!!this._all}return!!this._all},c.prototype.on=function(b,c){if("function"==typeof b)return this.onAny(b),this;if("function"!=typeof c)throw new Error("on only accepts instances of Function");if(this._events||a.call(this),this.emit("newListener",b,c),this.wildcard)return e.call(this,b,c),this;if(this._events[b]){if("function"==typeof this._events[b])this._events[b]=[this._events[b],c];else if(f(this._events[b])&&(this._events[b].push(c),!this._events[b].warned)){var d=g;"undefined"!=typeof this._events.maxListeners&&(d=this._events.maxListeners),d>0&&this._events[b].length>d&&(this._events[b].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[b].length),console.trace())}}else this._events[b]=c;return this},c.prototype.onAny=function(a){if("function"!=typeof a)throw new Error("onAny only accepts instances of Function");return this._all||(this._all=[]),this._all.push(a),this},c.prototype.addListener=c.prototype.on,c.prototype.off=function(a,b){if("function"!=typeof b)throw new Error("removeListener only takes instances of Function");var c,e=[];if(this.wildcard){var g="string"==typeof a?a.split(this.delimiter):a.slice();e=d.call(this,null,g,this.listenerTree,0)}else{if(!this._events[a])return this;c=this._events[a],e.push({_listeners:c})}for(var h=0;h<e.length;h++){var i=e[h];if(c=i._listeners,f(c)){for(var j=-1,k=0,l=c.length;l>k;k++)if(c[k]===b||c[k].listener&&c[k].listener===b||c[k]._origin&&c[k]._origin===b){j=k;break}if(0>j)continue;return this.wildcard?i._listeners.splice(j,1):this._events[a].splice(j,1),0===c.length&&(this.wildcard?delete i._listeners:delete this._events[a]),this}(c===b||c.listener&&c.listener===b||c._origin&&c._origin===b)&&(this.wildcard?delete i._listeners:delete this._events[a])}return this},c.prototype.offAny=function(a){var b,c=0,d=0;if(a&&this._all&&this._all.length>0){for(b=this._all,c=0,d=b.length;d>c;c++)if(a===b[c])return b.splice(c,1),this}else this._all=[];return this},c.prototype.removeListener=c.prototype.off,c.prototype.removeAllListeners=function(b){if(0===arguments.length)return!this._events||a.call(this),this;if(this.wildcard)for(var c="string"==typeof b?b.split(this.delimiter):b.slice(),e=d.call(this,null,c,this.listenerTree,0),f=0;f<e.length;f++){var g=e[f];g._listeners=null}else{if(!this._events[b])return this;this._events[b]=null}return this},c.prototype.listeners=function(b){if(this.wildcard){var c=[],e="string"==typeof b?b.split(this.delimiter):b.slice();return d.call(this,c,e,this.listenerTree,0),c}return this._events||a.call(this),this._events[b]||(this._events[b]=[]),f(this._events[b])||(this._events[b]=[this._events[b]]),this._events[b]},c.prototype.listenersAny=function(){return this._all?this._all:[]},"function"==typeof define&&define.amd?define("eventemitter",[],function(){return c}):"object"==typeof exports?exports.EventEmitter2=c:window.EventEmitter2=c}(),function(){var a;a=["on","onAny","offAny","once","many","off","removeAllListeners","listeners","listenersAny","emit","setMaxListeners"],define("lib/utils/emitter",["underscore","eventemitter"],function(b,c){return function(){var d,e,f,g,h;for(f=new c({wildcard:!0,delimiter:".",newListener:!1,maxListeners:100}),d={},g=0,h=a.length;h>g;g++)e=a[g],d[e]=b.bind(f[e],f);return d}})}.call(this),function(){define("lib/utils/cookies",["cookie"],function(a){return{set:a.set,get:a.get,remove:a.expire}})}.call(this),define("lib/utils/version",[],function(){return"0.8.39"}),function(){define("lib/api/params",["underscore"],function(a){var b,c,d;return b="hull",d=function(a){return[a,b,{}]},c=function(a){var c,d,e;return d=a.path,e=a.provider||b,c=a.params||{},[d,e,c]},{parse:function(b){var e,f,g,h,i,j,k,l,m,n,o,p;if(f=b.shift(),a.isString(f)&&(o=d(f),k=o[0],l=o[1],j=o[2]),a.isObject(f)&&(p=c(f),k=p[0],l=p[1],j=p[2]),!k)throw"No URI provided for the API call";for("/"===k[0]&&(k=k.substring(1)),m=[],null!=j&&m.push(j),m=m.concat(b),e=g=null,j={};i=m.shift();)if(n=typeof i,"string"!==n||h)if("function"!==n||e&&g){if("object"!==n)throw new TypeError("Invalid argument passed to Hull.api(): "+i);j=a.extend(j,i)}else e?g||(g=i):e=i;else h=i.toLowerCase();return null==h&&(h="get"),null==e&&(e=function(){}),null==g&&(g=function(a){return console.error("The request has failed: ",a)}),[{provider:l,path:k,method:h,params:j},e,g]}}})}.call(this),function(){var a;try{a=JSON.parse(atob(document.location.hash.replace("#",""))),window.opener&&window.opener.Hull&&window.opener.__hull_login_status__&&null!=a&&(window.opener.__hull_login_status__(a),window.close())}catch(b){}define("lib/api/auth",["underscore","../utils/promises","../utils/version"],function(b,c,d){return function(e,f,g,h){var i,j,k,l,m,n,o,p,q,r,s,t,u,v,w;return null==h&&(h=[]),j=null,w=null,o=function(a,d){var e,f,h;return e=c.deferred(),f=e.promise,f.then(function(){var b;return g.emit("hull.auth.login",d,a),null==(null!=d&&null!=(b=d.stats)?b.sign_in_count:void 0)?g.emit("hull.auth.create",d):void 0},function(a){return g.emit("hull.auth.fail",a)}),g.once("hull.settings.update",function(){return e.resolve(d)}),h=b.bind(e.reject,e),b.delay(h,3e4,new Error("Timeout for login")),f},p=function(a){throw g.emit("hull.auth.fail",a),a},k=b.bind(o,void 0,"email"),v=function(a){return e("users","post",a).then(k,p)},u=function(a,b,c){var d,e,f;null==b&&(b="post"),null==c&&(c={}),d=document.createElement("form"),d.setAttribute("method",b),d.setAttribute("action",a);for(f in c)c.hasOwnProperty(f)&&(e=document.createElement("input"),e.setAttribute("type","hidden"),e.setAttribute("name",f),e.setAttribute("value",c[f]),d.appendChild(e));return document.body.appendChild(d),d.submit()},m=function(){var a;return a=navigator.userAgent||navigator.vendor||window.opera,!!/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0,4))},n=function(a,c,d){var g,h,i,j;if(null==c&&(c={}),i=function(){return e.clearToken(),e("me")},b.isString(a)&&(a=b.isString(c)?{login:a,password:c}:{provider:a}),b.isObject(a.params)||a.params||(a.params=c),"facebook"===a.provider&&((j=a.params).display||(j.display="redirect"===a.strategy?"page":"popup")),"redirect"===a.strategy&&(a.redirect_url||(a.redirect_url=window.location.href)),null!=a.provider)h=q(a).then(i),g=h.then(b.bind(o,void 0,a),p);else{if(null==a.login||null==a.password)throw new Error("Seems like something is wrong in your Hull.login() call, We need a login and password fields to login. Read up here: http://www.hull.io/docs/references/hull_js/#user-signup-and-login");if(delete a.params,"redirect"===a.strategy)return u(f.orgUrl+"/api/v1/users/login","post",a);h=e("users/login","post",b.pick(a,"login","password")).then(i),g=h.then(k,p)}return b.isFunction(d)&&g.then(d),h},q=function(a){var d;return s.isAuthenticating()?s.isAuthenticating():(j=c.deferred(),~b.indexOf(h,a.provider)?(j.provider=a.provider,d=s.authUrl(f,a),"redirect"===a.strategy?window.location.href=d:s.authHelper(d,a),j.promise):(j.reject({message:"No authentication service "+a.provider+" configured for the app",reason:"no_such_service"}),j.promise))},r=function(a){var c;return c=e("logout"),c.done(function(){return b.isFunction(a)?a():void 0}),c.then(function(){return g.emit("hull.auth.logout")})},t=function(a){var b,c,d,e,f;if(e=j,j){if(a.success)j.resolve({});else{b=new Error("Login failed"),f=a.error;for(c in f)d=f[c],b[c]=d;j.reject(b)}return j=null,clearInterval(w),w=null,e}},l=function(a,c){var e,f;return null==c&&(c={}),s.createCallback(),e=c.params||{},e.app_id=a.appId,e.callback_url=c.redirect_url||e.callback_url||a.callback_url||a.callbackUrl||s.location.toString(),e.auth_referer=s.location.toString(),e.version=d,f=b.map(e,function(a,b){return encodeURIComponent(b)+"="+encodeURIComponent(a)}).join("&"),""+a.orgUrl+"/auth/"+c.provider+"?"+f},s={isAuthenticating:function(){return null!=j},location:document.location,authUrl:l,createCallback:function(){return window.__hull_login_status__=function(a){return window.__hull_login_status__=null,t(a)}},authHelper:function(b,c){var d,e,f,g,h;return null==c&&(c={}),e="location=0,status=0","facebook"===c.provider&&"popup"===c.params.display?(g=500,d=400):(g=1030,d=550),e=""+e+",width="+g+",height="+d,f=window.open(b,"_auth",e),(null!=(h=window.device)?h.cordova:void 0)&&null!=f&&f.addEventListener("loadstart",function(b){return a=function(){try{return JSON.parse(atob(b.url.split("#")[1]))}catch(a){}}(),a?(window.__hull_login_status__(a),f.close()):void 0}),w=null!=f&&setInterval(function(){return(null!=f?f.closed:void 0)?t({success:!1,error:{reason:"window_closed"}}):void 0},200)},onCompleteAuth:t},i={signup:v,login:n,logout:r,isAuthenticating:s.isAuthenticating}}})}.call(this),function(a){function b(a){return"[object Array]"===Object.prototype.toString.call(a)}function c(a){return"undefined"==typeof a}function d(a){if(!a)throw new Error("url is undefined or empty");if(/^file/.test(a))throw new Error("The file:// protocol is not supported");var b=a.toLowerCase().match(t);if(b){var c=b[2],d=b[3],e=b[4]||"";return("http:"===c&&":80"===e||"https:"===c&&":443"===e)&&(e=""),c+"//"+d+e}return a}function e(a){if(!a)throw new Error("url is undefined or empty");if(a=a.replace(v,"$1/"),!a.match(/^(http||https):\/\//)){var b="/"===a.substring(0,1)?"":location.pathname;"/"!==b.substring(b.length-1)&&(b=b.substring(0,b.lastIndexOf("/")+1)),a=location.protocol+"//"+location.host+b+a}for(;u.test(a);)a=a.replace(u,"");return a}function f(a,b,c){var d;for(var e in b)b.hasOwnProperty(e)&&(e in a?(d=b[e],"object"==typeof d?f(a[e],d,c):c||(a[e]=b[e])):a[e]=b[e]);return a}function g(a,b){"string"==typeof a&&(a=[a]);for(var c,d=a.length;d--;)if(c=a[d],c=new RegExp("^"===c.substr(0,1)?c:"^"+c.replace(/(\*)/g,".$1").replace(/\?/g,".")+"$"),c.test(b))return!0;return!1}function h(a,b){if(!b)throw new Error("parameters is undefined or null");var c=a.indexOf("#"),d=[];for(var e in b)b.hasOwnProperty(e)&&d.push(e+"="+encodeURIComponent(b[e]));return a+(-1===c?"#":"&")+d.join("&")}function i(a){var b=q.cloneNode(!1);if(f(a.props,{frameBorder:0,allowTransparency:!0,scrolling:"no",width:"100%",src:h(a.remote,{xdm_e:d(location.href),xdm_c:a.channel,xdm_p:1}),name:p+a.channel+"_provider",style:{margin:0,padding:0,border:0}}),b.id=a.props.name,delete a.props.name,!a.container)throw new Error('xdm.Rpc() configuration object missing a DOM "container" property');return f(b,a.props),a.container.appendChild(b),a.onLoad&&w(b,"load",a.onLoad),a.html&&(b.contentWindow.document.open(),b.contentWindow.document.write(a.html),b.contentWindow.document.close()),a.iframe=b,b}function j(a){var b;if(a.isHost=a.isHost||c(y.xdm_p),a.props=a.props||{},a.isHost)a.remote=e(a.remote),a.channel=a.channel||"default"+r++;else if(a.channel=y.xdm_c.replace(/["'<>\\]/g,""),a.remote=y.xdm_e.replace(/["'<>\\]/g,""),a.acl&&!g(a.acl,a.remote))throw new Error("Access denied for "+a.remote);return b=[new n.stack.PostMessageTransport(a)],b.push(new n.stack.QueueBehavior(!0)),b}function k(a){var b,c,d=a.length,e={incoming:function(a,b){this.up.incoming(a,b)},outgoing:function(a,b){this.down.outgoing(a,b)},callback:function(a){this.up.callback(a)},init:function(){this.down.init()},destroy:function(){this.down.destroy()}};for(c=0;d>c;c++)b=a[c],f(b,e,!0),0!==c&&(b.down=a[c-1]),c!==d-1&&(b.up=a[c+1]);return b}function l(a){a.up.down=a.down,a.down.up=a.up,a.up=a.down=null}if(a.postMessage){var m="",n={},o=a.xdm,p="xdm_",q=document.createElement("IFRAME"),r=Math.floor(1e4*Math.random()),s=Function.prototype,t=/^((http.?:)\/\/([^:\/\s]+)(:\d+)*)/,u=/[\-\w]+\/\.\.\//,v=/([^:])\/\//g,w=function(){return a.addEventListener?function(a,b,c){a.addEventListener(b,c,!1)}:function(a,b,c){a.attachEvent("on"+b,c)}}(),x=function(){return a.removeEventListener?function(a,b,c){a.removeEventListener(b,c,!1)}:function(a,b,c){a.detachEvent("on"+b,c)}}(),y=function(a){a=a.substring(1,a.length).split("&");for(var b,c={},d=a.length;d--;)b=a[d].split("="),c[b[0]]=decodeURIComponent(b[1]);return c}(location.hash);n.version="1.0.1",n.stack={},n.query=y,n.checkAcl=g,n.noConflict=function(b){return a.xdm=o,m=b,m&&(p="xdm_"+m.replace(".","_")+"_"),n},n.Rpc=function(a,b){var c;if(b.local)for(var e in b.local)b.local.hasOwnProperty(e)&&(c=b.local[e],"function"==typeof c&&(b.local[e]={method:c}));var f=k(j(a).concat([new n.stack.RpcBehavior(this,b),{callback:function(b){a.onReady&&a.onReady(b)}}]));this.origin=d(a.remote),this.destroy=function(){f.destroy()},f.init(),this.iframe=a.iframe},n.stack.PostMessageTransport=function(b){function c(a){var c=d(a.origin),f="string"==typeof a.data;c===h&&f&&a.data.substring(0,b.channel.length+1)===b.channel+" "&&e.up.incoming(a.data.substring(b.channel.length+1),c)}var e,f,g,h;return e={outgoing:function(a,c,d){g.postMessage(b.channel+" "+a,c||h),d&&d()},destroy:function(){x(a,"message",c),f&&(g=null,f.parentNode.removeChild(f),f=null)},init:function(){if(h=d(b.remote),b.isHost){var j=function(d){d.data===b.channel+"-ready"&&(g="postMessage"in f.contentWindow?f.contentWindow:f.contentWindow.document,x(a,"message",j),w(a,"message",c),setTimeout(function(){e.up.callback(!0)},0))};w(a,"message",j),f=i(b)}else w(a,"message",c),g="postMessage"in a.parent?a.parent:a.parent.document,g.postMessage(b.channel+"-ready",h),setTimeout(function(){e.up.callback(!0)},0)}}},n.stack.QueueBehavior=function(a){function b(){var g;return a===!0&&0===e.length?void l(c):void(f||0===e.length||d||(f=!0,g=e.shift(),c.down.outgoing(g.data,g.origin,function(a){f=!1,g.callback&&setTimeout(function(){g.callback(a)},0),b()})))}var c,d,e=[],f=!0;return c={init:function(){c.down.init()},callback:function(a){f=!1;var d=c.up;b(),d.callback(a)},incoming:function(a,b){c.up.incoming(a,b)},outgoing:function(a,c,d){e.push({data:a,origin:c,callback:d}),b()},destroy:function(){d=!0,c.down.destroy()}}},n.stack.RpcBehavior=function(a,d){function e(a){a.jsonrpc="2.0",h.down.outgoing(JSON.stringify(a))}function f(a,b){var c=Array.prototype.slice;return function(){var d,f=arguments.length,g={method:b};f>0&&"function"==typeof arguments[f-1]?(f>1&&"function"==typeof arguments[f-2]?(d={success:arguments[f-2],error:arguments[f-1]},g.params=c.call(arguments,0,f-2)):(d={success:arguments[f-1]},g.params=c.call(arguments,0,f-1)),j[""+ ++i]=d,g.id=i):g.params=c.call(arguments,0),a.namedParams&&1===g.params.length&&(g.params=g.params[0]),e(g)}}function g(a,d,f,g){if(!f)return void(d&&e({id:d,error:{code:-32601,message:"Procedure not found."}}));var h,i;d?(h=function(a){h=s,e({id:d,result:a})},i=function(a,b){i=s;var c={id:d,error:{code:-32099,message:a}};b&&(c.error.data=b),e(c)}):h=i=s,b(g)||(g=[g]);try{var j=f.method.apply(f.scope,g.concat([h,i]));c(j)||h(j)}catch(k){i(k.message)}}var h,i=0,j={};return h={incoming:function(a){var b,c=JSON.parse(a);c.method?d.handle?d.handle(c,e):g(c.method,c.id,d.local[c.method],c.params):(b=j[c.id],c.error&&b.error?b.error(c.error):b.success&&b.success(c.result),delete j[c.id])},init:function(){if(d.remote)for(var b in d.remote)d.remote.hasOwnProperty(b)&&(a[b]=f(d.remote[b],b));h.down.init()},destroy:function(){for(var b in d.remote)d.remote.hasOwnProperty(b)&&a.hasOwnProperty(b)&&delete a[b];h.down.destroy()}}},"object"==typeof exports?module.exports=n:"function"==typeof define&&define.amd?define("xdm",[],function(){return n}):a.xdm=n}}(window),function(){define("lib/api/xdm",["domready","lib/utils/promises","xdm","lib/utils/version","underscore"],function(a,b,c,d,e){var f;return f=function(a){var b,c;return c=""+a.orgUrl+"/api/v1/"+a.appId+"/remote.html?v="+d,a.jsUrl&&(c+="&js="+a.jsUrl),a.uid&&(c+="&uid="+a.uid),a.debugRemote&&(c+="&debug_remote=true"),b=a.accessToken||a.appSecret,null!=b&&(c+="&access_token="+b),void 0!==a.userHash&&(c+="&user_hash="+a.userHash),c+="&r="+encodeURIComponent(document.referrer)},function(d,g){var h,i,j,k,l,m,n,o,p,q,r,s,t;return s=null,o=null,i=b.deferred(),m=function(a){return console.log("remoteMessage",a),a.error?i.reject(a.error):console.warn("RPC Message",arguments)},p=function(a){return g.emit("hull.settings.update",a)},t=function(a){return g.emit("hull.auth.update",a)},n=function(a){return window.clearTimeout(s),i.resolve({rpc:o,config:a})},j=function(){return d},k={top:"-20px",left:"-20px",bottom:"auto",right:"auto",width:"1px",height:"1px",display:"block",position:"fixed",zIndex:void 0,overflow:"hidden"},r={top:"0px",left:"0px",right:"0px",bottom:"0px",width:"100%",height:"100%",display:"block",position:"fixed",zIndex:1e4,overflow:"auto"},q=function(){return h(r)},l=function(){return h(k)},h=function(a){return e.map(a,function(a,b){return o.iframe.style[b]=a})},a(function(){return s=setTimeout(function(){return i.reject('Remote loading has failed. Please check "orgUrl" and "appId" in your configuration. This may also be about connectivity.')},3e4),o=new c.Rpc({remote:f(d),container:document.body,channel:d.appId,props:{tabIndex:-1,height:"0",width:"1px",style:{position:"fixed",width:"1px",height:"1px",top:"-20px",left:"-20px",overflow:"hidden"}}},{remote:{message:{},ready:{},clearUserToken:{}},local:{message:m,ready:n,userUpdate:t,settingsUpdate:p,getClientConfig:j,show:q,hide:l}})}),i.promise}})}.call(this),function(){define("lib/api/api",["underscore","../utils/cookies","../utils/version","../api/params","../api/auth","../utils/promises","lib/api/xdm"],function(a,b,c,d,e,f,g){var h,i;return i=Array.prototype.slice,h=!1,{init:function(c,j){var k,l,m,n,o,p;if(null==c&&(c={}),l=f.deferred(),!c.orgUrl||!c.appId)return c.orgUrl||l.reject(new ReferenceError("no organizationURL provided. Can't proceed")),c.appId||l.reject(new ReferenceError("no applicationID provided. Can't proceed")),l.promise;try{window.jQuery&&a.isFunction(window.jQuery.fn.ajaxSend)&&window.jQuery(document).ajaxSend(function(a,b,c){return h&&!c.crossDomain?b.setRequestHeader("Hull-User-Sig",h):void 0})}catch(q){}return m=null,k=function(){return m.apply(void 0,d.parse(i.call(arguments)))},a.each(["get","post","put","delete"],function(a){return k[a]=function(){var b,c;return b=d.parse(i.call(arguments)),c=b[0],c.method=a,m.apply(k,b)}}),k.parseRoute=d.parse,p=function(a){var d,e;return null==a&&(a={}),c.appId?(d="hull_"+c.appId,a&&a["Hull-User-Id"]&&a["Hull-User-Sig"]?(e=btoa(JSON.stringify(a)),h=e,b.set(d,e,{path:"/"})):(h=!1,b.remove(d,{path:"/"}))):void 0},o=null,k.clearToken=function(){return o.clearUserToken()},n=function(b){var d,f,g,h;return o=b.rpc,g=b.config,f=g.data,p(f.headers),(null!=(h=f.headers)?h["Hull-Auth-Scope"]:void 0)&&(d=f.headers["Hull-Auth-Scope"].split(":")[0]),{auth:e(k,c,j,a.keys(g.settings.auth||{})),remoteConfig:g,authScope:d||"",api:k,init:function(){return l.promise}}},g(c,j).then(n).then(l.resolve,l.reject),m=function(a,b,c){var d,e,g;return o||console.error("Api not initialized yet"),d=f.deferred(),g=function(a){var c,e,f,g,h;if(null==a&&(a={}),"hull"===a.provider&&p(a.headers),e=null!=a?a.headers:void 0,null!=e&&"hull"===a.provider&&(f=e["Hull-Track"]))try{h=JSON.parse(atob(f)),c=h[0],g=h[1],j.emit(c,g)}catch(i){}return b(a.response,a.headers),d.resolve(a.response)},e=function(a){return null==a&&(a={}),c(a.message),d.reject(a.message)},o.message(a,g,e),d.promise},l.promise}}})}.call(this),function(){define("lib/api/reporting",["underscore"],function(a){return{init:function(b){return{track:function(c,d){var e;return e=a.extend({url:window.location.href,referrer:document.referrer},d),b.api({provider:"track",path:c},"post",e)},flag:function(a){return b.api({provider:"hull",path:[a,"flag"].join("/")},"post")}}}}})}.call(this),function(){define("lib/utils/base64",[],function(){var a;return a=window,{utils:a,decode:function(b){return a.decodeURIComponent(a.escape(a.atob(b)))},encode:function(b){return a.btoa(a.unescape(a.encodeURIComponent(b)))},utilsContainer:window}})}.call(this),function(){define("lib/utils/entity",["underscore","lib/utils/base64"],function(a,b){return{decode:function(a){return/^~[a-z0-9_\-\+\/\=]+$/i.test(a)&&(a.length-1)%4===0?b.decode(a.substr(1),!0):a},encode:function(a){return"~"+b.encode(a,!0)
}}})}.call(this),function(){define("lib/utils/config",["underscore"],function(a){var b,c;return c=function(a){return void 0!==a?JSON.parse(JSON.stringify(a)):void 0},b=function(b,d){return d&&d.on("hull.settings.update",function(a){return b.services=a}),function(d){var e;return e=b,d?(a.each(d.split("."),function(b){return void 0===e?e:e=a.contains(a.keys(e),b)?e[b]:void 0}),c(e)):c(b)}},function(a,c){return b(a,c)}})}.call(this),function(){define("lib/api/current-user",[],function(){return function(a){var b;return b=!1,a.on("hull.init",function(a,c){return b=c}),a.on("hull.auth.login",function(a){return b=a}),a.on("hull.auth.update",function(c){return(null!=b?b.id:void 0)?b.id===c.id?b=c:(null!=c?c.id:void 0)?a.emit("hull.auth.login",c):a.emit("hull.auth.logout"):void 0}),a.on("hull.auth.logout",function(){return b=!1}),function(){return b}}})}.call(this),function(){define("lib/traits/base",["underscore"],function(a){var b,c;return b=function(){function b(b,c,d){this.api=b,this.name=c,this.value=d,this.api||(this.api=function(){}),a.isUndefined(this.value)||this.set(this.value)}return b.prototype.inc=function(a){return null==a&&(a=1),this.api("me/traits","put",{name:this.name,operation:"inc",value:a})},b.prototype.dec=function(a){return null==a&&(a=1),this.api("me/traits","put",{name:this.name,operation:"dec",value:a})},b.prototype.set=function(a){return this.api("me/traits","put",{name:this.name,operation:"set",value:a})},b}(),c={api:null},{setup:function(a){return c.api=a,{build:function(a,d){return new b(c.api,a,d)}}}}})}.call(this),function(){define("lib/share/base",["underscore","../utils/promises"],function(a,b){var c,d,e,f,g,h,i,j;return g=function(){var a;return a=navigator.userAgent||navigator.vendor||window.opera,!!/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0,4))},f=function(b){var c,d;return c=null!=(d=Hull.currentUser())?d.identities:void 0,c&&b?a.some(c,function(a){return a.provider===b}):!1},h=function(b){return a.map(b,function(a,b){return encodeURIComponent(b)+"="+encodeURIComponent(a)}).join("&")},d=function(a){var b,d;return a.method||(a.method="share"),b=a.params,"share"===a.method&&(b.href||(b.href=window.location.href)),"feed"===a.method&&(b.link||(b.link=window.location.href)),d=function(){return Hull.api({provider:a.provider,path:"ui."+a.method},b)},g()||"popup"===b.display?c(a):a.anonymous||f("facebook")?d():Hull.login({provider:"facebook",strategy:"popup"}).then(d)},e=function(a,c){var d,e,f,g;return f=h(c.params),g=window.open(""+a+"?"+f,"hull_share","location=0,status=0,width="+c.width+",height="+c.height),d=b.deferred(),e=setInterval(function(){try{if(null===g||g.closed)return window.clearInterval(e),d.resolve({display:"popup"})}catch(a){return!0}},500),d.promise},c=function(a){var b,c;return b=a.params,b.redirect_uri=window.location.href,b.app_id=Hull.config("services").auth.facebook.appId,c="popup"===b.display?[500,400]:[1030,550],a.width=c[0],a.height=c[1],e("https://www.facebook.com/dialog/"+a.method,a)},i=function(a){var b;return b=[550,420],a.width=b[0],a.height=b[1],e("https://twitter.com/intent/tweet",a)},j=function(a){var b;return b=a.params,b.url||(b.url=window.location.href),i(a)},function(c){var e,f;return a.isObject(c)&&a.isObject(c.params)&&null!=c.provider?(f=function(){switch(c.provider){case"facebook":return d(c);case"twitter":return j(c)}}(),f.then(function(a){return Hull.track("hull."+c.provider+".share",{params:c.params,response:a}),a})):(e=b.deferred(),e.reject(),e)}})}.call(this),function(){var a=[].slice;define("flavour",["underscore","lib/utils/promises","lib/utils/emitter","lib/api/api","lib/api/reporting","lib/utils/entity","lib/utils/config","lib/api/current-user","lib/traits/base","lib/share/base"],function(b,c,d,e,f,g,h,i,j,k){var l,m;return l=function(m){var n;return n=d(),e.init(m,n).then(function(d){var e,o,p;return p=f.init(d),n.on("hull.auth.create",function(a){var c;return c=b.pluck(a.identities,"provider"),p.track("hull.auth.create",{providers:c,main_identity:a.main_identity})}),n.on("hull.auth.login",function(a,c){var d;return d=b.pluck(a.identities,"provider"),c=c||a.main_identity,p.track("hull.auth.login",{provider:c,providers:d,main_identity:a.main_identity})}),n.on("hull.auth.logout",function(){return p.track("hull.auth.logout")}),o=c.deferred(),o.promise.fail(function(){}),o.reject({reason:"no_current_user",message:"User must be logged in to perform this action"}),m.services=d.remoteConfig.settings,e={config:h(m,n),on:n.on,off:n.off,emit:n.emit,track:p.track,flag:p.flag,api:d.api,currentUser:i(n),signup:function(){var b,c,e;return b=1<=arguments.length?a.call(arguments,0):[],c=(e=d.auth).signup.apply(e,b)},login:function(){var b,c;return b=1<=arguments.length?a.call(arguments,0):[],d.auth.isAuthenticating()?console.info("Authentication is in progress. Use `Hull.on('hull.auth.login', fn)` to call `fn` when done."):(c=d.auth).login.apply(c,b)},logout:d.auth.logout,linkIdentity:function(a,b,c){return null==b&&(b={}),e.currentUser()?(b.mode="connect",e.login(a,b,c)):o.promise},unlinkIdentity:function(a,b){var c;return e.currentUser()?(c=d.api("me/identities/"+a,"delete").then(d.api.bind(d,"me")),c.then(function(a){return n.emit("hull.auth.login",a),b(a)}),c):o.promise},util:{entity:g},trait:j.setup(d.api).build,share:k},e.api.create=l,{raw:d,api:e,eventEmitter:n}})},m=function(a){throw console.error("Unable to start Hull.api",a.message),a},{init:function(a){return l(a)},success:function(a){return{exports:a.api,context:{me:a.raw.remoteConfig.data.me,app:a.raw.remoteConfig.data.app,org:a.raw.remoteConfig.data.org}}},failure:m}})}.call(this),function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r=[].slice;window.console&&console.log||!function(){var a,b,c,d,e;for(d=function(){},c=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","markTimeline","table","time","timeEnd","timeStamp","trace","warn"],b=c.length,a=window.console={},e=[];b--;)e.push(a[c[b]]=d);return e}(),a="undefined"!=typeof HULL_ENV&&null!==HULL_ENV?HULL_ENV:"",n=null,d=null,b=function(){var a,b;return b=!1,a=[],{run:function(c){return b?c():a.push(c)},unlock:function(){var c,d,e,f;for(b=!0,f=[],d=0,e=a.length;e>d;d++)c=a[d],f.push(c());return f}}},q=q||{},c=function(a){var b;return null==(b=q[a])&&(q[a]=[]),function(){var b;return b=1<=arguments.length?r.call(arguments,0):[],q[a].push(b)}},e=function(a){return delete q[a]},l=function(a,b){var c,d,f,g;for(g=q[a],d=0,f=g.length;f>d;d++)c=g[d],b[a].apply(b,c);return e(a)},j=b(),p=!1,k=function(a,b,c,e){if(a&&p)throw new Error("Hull.init can be called only once");return a&&(p=!0),j.run(function(){var h,i,j;return h=n({},b),null!=h.track&&(h.track=g(h.track)),h.namespace="hull",h.debug=b.debug&&{enable:!0},j=function(){var d;return d=1<=arguments.length?r.call(arguments,0):[],m.apply(null,[b,a,c||function(){}].concat(d))},i=function(){var b;return b=1<=arguments.length?r.call(arguments,0):[],f.apply(null,[a,e||function(){}].concat(b))},d.init(h).then(j,i).done(),console.info('Hull.js version "'+o.version+'" started')})},h=function(){var a,b;return b=arguments[0],a=2<=arguments.length?r.call(arguments,1):[],b.apiOnly=!0,k.apply(null,[!1,b].concat(a))},i=function(){var a,b;return b=arguments[0],a=2<=arguments.length?r.call(arguments,1):[],k.apply(null,[!0,b].concat(a))},g=function(a){var b,c,d;if(null!=a)return d=function(){},c=function(){switch(Object.prototype.toString.call(a).match(/^\[object (.*)\]$/)[1]){case"Object":if(null!=a.only)return{only:function(){var c,d,e,f;for(e=a.only,f=[],c=0,d=e.length;d>c;c++)b=e[c],f.push(b.toString());return f}()};if(null!=a.ignore)return{ignore:function(){var c,d,e,f;for(e=a.ignore,f=[],c=0,d=e.length;d>c;c++)b=e[c],f.push(b.toString());return f}()};break;case"RegExp":return{only:a.toString()};case"Array":return{only:function(){var c,d,e;for(e=[],c=0,d=a.length;d>c;c++)b=a[c],e.push(b.toString());return e}()}}}()},o=window.Hull={on:c("on"),track:c("track"),ready:c("ready"),init:i},o.init.api=h,"client"===a&&(o.component=c("component")),m=function(){var b,c,e,f,g,h,i,j;return c=arguments[0],g=arguments[1],h=arguments[2],b=4<=arguments.length?r.call(arguments,3):[],f=d.success.apply(d,b),e=f.context,i=n({},c),j=n({},o,f.exports,{ready:function(a){return a(j,e.me,e.app,e.org)}}),g?(window.Hull=j,l("on",j),l("track",j),"client"===a&&l("component",j)):delete j.component,l("ready",j),j.emit("hull.init",j,f.context.me,f.context.app,f.context.org),h(j,f.context.me,f.context.app,f.context.org),j},f=function(){var a,b,c,e;return c=arguments[0],e=arguments[1],b=arguments[2],a=4<=arguments.length?r.call(arguments,3):[],d.failure(b),e.apply(null,[b].concat(a))},require(["flavour","underscore","lib/utils/version"],function(a,b,c){return o.version=c,n=b.extend,d=a,j.unlock()})}.call(this),define("lib/bootstrap",function(){})}).call(root)}();